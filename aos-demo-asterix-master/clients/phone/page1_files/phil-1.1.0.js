/*!
 * jQuery Form Plugin
 * version: 3.35.0-2013.05.23
 * @requires jQuery v1.5 or later
 * Copyright (c) 2013 M. Alsup
 * Examples and documentation at: http://malsup.com/jquery/form/
 * Project repository: https://github.com/malsup/form
 * Dual licensed under the MIT and GPL licenses.
 * https://github.com/malsup/form#copyright-and-license
 */
(function(f){var c={};
c.fileapi=f("<input type='file'/>").get(0).files!==undefined;c.formdata=window.FormData!==undefined;var e=!!f.fn.prop;f.fn.attr2=function(){if(!e){return this.attr.apply(this,arguments);}var g=this.prop.apply(this,arguments);if((g&&g.jquery)||typeof g==="string"){return g;}return this.attr.apply(this,arguments);
};f.fn.ajaxSubmit=function(l){if(!this.length){d("ajaxSubmit: skipping submit process - no element selected");return this;}var i,D,n,p=this;if(typeof l=="function"){l={success:l};}i=l.type||this.attr2("method");D=l.url||this.attr2("action");n=(typeof D==="string")?f.trim(D):"";n=n||window.location.href||"";
if(n){n=(n.match(/^([^#]+)/)||[])[1];}l=f.extend(true,{url:n,success:f.ajaxSettings.success,type:i||"GET",iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank"},l);var v={};this.trigger("form-pre-serialize",[this,l,v]);if(v.veto){d("ajaxSubmit: submit vetoed via form-pre-serialize trigger");
return this;}if(l.beforeSerialize&&l.beforeSerialize(this,l)===false){d("ajaxSubmit: submit aborted via beforeSerialize callback");return this;}var o=l.traditional;if(o===undefined){o=f.ajaxSettings.traditional;}var t=[];var F,G=this.formToArray(l.semantic,t);if(l.data){l.extraData=l.data;F=f.param(l.data,o);
}if(l.beforeSubmit&&l.beforeSubmit(G,this,l)===false){d("ajaxSubmit: submit aborted via beforeSubmit callback");return this;}this.trigger("form-submit-validate",[G,this,l,v]);if(v.veto){d("ajaxSubmit: submit vetoed via form-submit-validate trigger");return this;}var z=f.param(G,o);if(F){z=(z?(z+"&"+F):F);
}if(l.type.toUpperCase()=="GET"){l.url+=(l.url.indexOf("?")>=0?"&":"?")+z;l.data=null;}else{l.data=z;}var I=[];if(l.resetForm){I.push(function(){p.resetForm();});}if(l.clearForm){I.push(function(){p.clearForm(l.includeHidden);});}if(!l.dataType&&l.target){var m=l.success||function(){};I.push(function(q){var k=l.replaceTarget?"replaceWith":"html";
f(l.target)[k](q).each(m,arguments);});}else{if(l.success){I.push(l.success);}}l.success=function(L,q,M){var K=l.context||this;for(var J=0,k=I.length;J<k;J++){I[J].apply(K,[L,q,M||p,p]);}};if(l.error){var A=l.error;l.error=function(K,k,q){var J=l.context||this;A.apply(J,[K,k,q,p]);};}if(l.complete){var h=l.complete;
l.complete=function(J,k){var q=l.context||this;h.apply(q,[J,k,p]);};}var E=f('input[type=file]:enabled[value!=""]',this);var r=E.length>0;var C="multipart/form-data";var y=(p.attr("enctype")==C||p.attr("encoding")==C);var x=c.fileapi&&c.formdata;d("fileAPI :"+x);var s=(r||y)&&!x;var w;if(l.iframe!==false&&(l.iframe||s)){if(l.closeKeepAlive){f.get(l.closeKeepAlive,function(){w=H(G);
});}else{w=H(G);}}else{if((r||y)&&x){w=u(G);}else{w=f.ajax(l);}}p.removeData("jqxhr").data("jqxhr",w);for(var B=0;B<t.length;B++){t[B]=null;}this.trigger("form-submit-notify",[this,l]);return this;function g(L){var M=f.param(L,l.traditional).split("&");var q=M.length;var k=[];var K,J;for(K=0;K<q;K++){M[K]=M[K].replace(/\+/g," ");
J=M[K].split("=");k.push([decodeURIComponent(J[0]),decodeURIComponent(J[1])]);}return k;}function u(q){var k=new FormData();for(var J=0;J<q.length;J++){k.append(q[J].name,q[J].value);}if(l.extraData){var M=g(l.extraData);for(J=0;J<M.length;J++){if(M[J]){k.append(M[J][0],M[J][1]);}}}l.data=null;var L=f.extend(true,{},f.ajaxSettings,l,{contentType:false,processData:false,cache:false,type:i||"POST"});
if(l.uploadProgress){L.xhr=function(){var N=jQuery.ajaxSettings.xhr();if(N.upload){N.upload.addEventListener("progress",function(R){var Q=0;var O=R.loaded||R.position;var P=R.total;if(R.lengthComputable){Q=Math.ceil(O/P*100);}l.uploadProgress(R,O,P,Q);},false);}return N;};}L.data=null;var K=L.beforeSend;
L.beforeSend=function(O,N){N.data=k;if(K){K.call(this,O,N);}};return f.ajax(L);}function H(ag){var M=p[0],L,ac,W,ae,Z,O,R,P,Q,aa,ad,U;var aj=f.Deferred();if(ag){for(ac=0;ac<t.length;ac++){L=f(t[ac]);if(e){L.prop("disabled",false);}else{L.removeAttr("disabled");}}}W=f.extend(true,{},f.ajaxSettings,l);
W.context=W.context||W;Z="jqFormIO"+(new Date().getTime());if(W.iframeTarget){O=f(W.iframeTarget);aa=O.attr2("name");if(!aa){O.attr2("name",Z);}else{Z=aa;}}else{O=f('<iframe name="'+Z+'" src="'+W.iframeSrc+'" />');O.css({position:"absolute",top:"-1000px",left:"-1000px"});}R=O[0];P={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(ak){var al=(ak==="timeout"?"timeout":"aborted");
d("aborting upload... "+al);this.aborted=1;try{if(R.contentWindow.document.execCommand){R.contentWindow.document.execCommand("Stop");}}catch(am){}O.attr("src",W.iframeSrc);P.error=al;if(W.error){W.error.call(W.context,P,al,ak);}if(ae){f.event.trigger("ajaxError",[P,W,al]);}if(W.complete){W.complete.call(W.context,P,al);
}}};ae=W.global;if(ae&&0===f.active++){f.event.trigger("ajaxStart");}if(ae){f.event.trigger("ajaxSend",[P,W]);}if(W.beforeSend&&W.beforeSend.call(W.context,P,W)===false){if(W.global){f.active--;}aj.reject();return aj;}if(P.aborted){aj.reject();return aj;}Q=M.clk;if(Q){aa=Q.name;if(aa&&!Q.disabled){W.extraData=W.extraData||{};
W.extraData[aa]=Q.value;if(Q.type=="image"){W.extraData[aa+".x"]=M.clk_x;W.extraData[aa+".y"]=M.clk_y;}}}var V=1;var S=2;function T(am){var al=null;try{if(am.contentWindow){al=am.contentWindow.document;}}catch(ak){d("cannot get iframe.contentWindow document: "+ak);}if(al){return al;}try{al=am.contentDocument?am.contentDocument:am.document;
}catch(ak){d("cannot get iframe.contentDocument: "+ak);al=am.document;}return al;}var K=f("meta[name=csrf-token]").attr("content");var J=f("meta[name=csrf-param]").attr("content");if(J&&K){W.extraData=W.extraData||{};W.extraData[J]=K;}function ab(){var am=p.attr2("target"),ak=p.attr2("action");M.setAttribute("target",Z);
if(!i){M.setAttribute("method","POST");}if(ak!=W.url){M.setAttribute("action",W.url);}if(!W.skipEncodingOverride&&(!i||/post/i.test(i))){p.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"});}if(W.timeout){U=setTimeout(function(){ad=true;Y(V);},W.timeout);}function an(){try{var ar=T(R).readyState;
d("state = "+ar);if(ar&&ar.toLowerCase()=="uninitialized"){setTimeout(an,50);}}catch(at){d("Server abort: ",at," (",at.name,")");Y(S);if(U){clearTimeout(U);}U=undefined;}}var al=[];try{if(W.extraData){for(var aq in W.extraData){if(W.extraData.hasOwnProperty(aq)){if(f.isPlainObject(W.extraData[aq])&&W.extraData[aq].hasOwnProperty("name")&&W.extraData[aq].hasOwnProperty("value")){al.push(f('<input type="hidden" name="'+W.extraData[aq].name+'">').val(W.extraData[aq].value).appendTo(M)[0]);
}else{al.push(f('<input type="hidden" name="'+aq+'">').val(W.extraData[aq]).appendTo(M)[0]);}}}}if(!W.iframeTarget){O.appendTo("body");if(R.attachEvent){R.attachEvent("onload",Y);}else{R.addEventListener("load",Y,false);}}setTimeout(an,15);try{M.submit();}catch(ao){var ap=document.createElement("form").submit;
ap.apply(M);}}finally{M.setAttribute("action",ak);if(am){M.setAttribute("target",am);}else{p.removeAttr("target");}f(al).remove();}}if(W.forceSync){ab();}else{setTimeout(ab,10);}var ah,ai,af=50,N;function Y(aq){if(P.aborted||N){return;}ai=T(R);if(!ai){d("cannot access response document");aq=S;}if(aq===V&&P){P.abort("timeout");
aj.reject(P,"timeout");return;}else{if(aq==S&&P){P.abort("server abort");aj.reject(P,"error","server abort");return;}}if(!ai||ai.location.href==W.iframeSrc){if(!ad){return;}}if(R.detachEvent){R.detachEvent("onload",Y);}else{R.removeEventListener("load",Y,false);}var ao="success",at;try{if(ad){throw"timeout";
}var an=W.dataType=="xml"||ai.XMLDocument||f.isXMLDoc(ai);d("isXml="+an);if(!an&&window.opera&&(ai.body===null||!ai.body.innerHTML)){if(--af){d("requeing onLoad callback, DOM not available");setTimeout(Y,250);return;}}var au=ai.body?ai.body:ai.documentElement;P.responseText=au?au.innerHTML:null;P.responseXML=ai.XMLDocument?ai.XMLDocument:ai;
if(an){W.dataType="xml";}P.getResponseHeader=function(ax){var aw={"content-type":W.dataType};return aw[ax];};if(au){P.status=Number(au.getAttribute("status"))||P.status;P.statusText=au.getAttribute("statusText")||P.statusText;}var ak=(W.dataType||"").toLowerCase();var ar=/(json|script|text)/.test(ak);
if(ar||W.textarea){var ap=ai.getElementsByTagName("textarea")[0];if(ap){P.responseText=ap.value;P.status=Number(ap.getAttribute("status"))||P.status;P.statusText=ap.getAttribute("statusText")||P.statusText;}else{if(ar){var al=ai.getElementsByTagName("pre")[0];var av=ai.getElementsByTagName("body")[0];
if(al){P.responseText=al.textContent?al.textContent:al.innerText;}else{if(av){P.responseText=av.textContent?av.textContent:av.innerText;}}}}}else{if(ak=="xml"&&!P.responseXML&&P.responseText){P.responseXML=X(P.responseText);}}try{ah=k(P,ak,W);}catch(am){ao="parsererror";P.error=at=(am||ao);}}catch(am){d("error caught: ",am);
ao="error";P.error=at=(am||ao);}if(P.aborted){d("upload aborted");ao=null;}if(P.status){ao=(P.status>=200&&P.status<300||P.status===304)?"success":"error";}if(ao==="success"){if(W.success){W.success.call(W.context,ah,"success",P);}aj.resolve(P.responseText,"success",P);if(ae){f.event.trigger("ajaxSuccess",[P,W]);
}}else{if(ao){if(at===undefined){at=P.statusText;}if(W.error){W.error.call(W.context,P,ao,at);}aj.reject(P,"error",at);if(ae){f.event.trigger("ajaxError",[P,W,at]);}}}if(ae){f.event.trigger("ajaxComplete",[P,W]);}if(ae&&!--f.active){f.event.trigger("ajaxStop");}if(W.complete){W.complete.call(W.context,P,ao);
}N=true;if(W.timeout){clearTimeout(U);}setTimeout(function(){if(!W.iframeTarget){O.remove();}P.responseXML=null;},100);}var X=f.parseXML||function(ak,al){if(window.ActiveXObject){al=new ActiveXObject("Microsoft.XMLDOM");al.async="false";al.loadXML(ak);}else{al=(new DOMParser()).parseFromString(ak,"text/xml");
}return(al&&al.documentElement&&al.documentElement.nodeName!="parsererror")?al:null;};var q=f.parseJSON||function(ak){return window["eval"]("("+ak+")");};var k=function(ap,an,am){var al=ap.getResponseHeader("content-type")||"",ak=an==="xml"||!an&&al.indexOf("xml")>=0,ao=ak?ap.responseXML:ap.responseText;
if(ak&&ao.documentElement.nodeName==="parsererror"){if(f.error){f.error("parsererror");}}if(am&&am.dataFilter){ao=am.dataFilter(ao,an);}if(typeof ao==="string"){if(an==="json"||!an&&al.indexOf("json")>=0){ao=q(ao);}else{if(an==="script"||!an&&al.indexOf("javascript")>=0){f.globalEval(ao);}}}return ao;
};return aj;}};f.fn.ajaxForm=function(g){g=g||{};g.delegation=g.delegation&&f.isFunction(f.fn.on);if(!g.delegation&&this.length===0){var h={s:this.selector,c:this.context};if(!f.isReady&&h.s){d("DOM not ready, queuing ajaxForm");f(function(){f(h.s,h.c).ajaxForm(g);});return this;}d("terminating; zero elements found by selector"+(f.isReady?"":" (DOM not ready)"));
return this;}if(g.delegation){f(document).off("submit.form-plugin",this.selector,b).off("click.form-plugin",this.selector,a).on("submit.form-plugin",this.selector,g,b).on("click.form-plugin",this.selector,g,a);return this;}return this.ajaxFormUnbind().bind("submit.form-plugin",g,b).bind("click.form-plugin",g,a);
};function b(h){var g=h.data;if(!h.isDefaultPrevented()){h.preventDefault();f(this).ajaxSubmit(g);}}function a(l){var k=l.target;var h=f(k);if(!(h.is("[type=submit],[type=image]"))){var g=h.closest("[type=submit]");if(g.length===0){return;}k=g[0];}var i=this;i.clk=k;if(k.type=="image"){if(l.offsetX!==undefined){i.clk_x=l.offsetX;
i.clk_y=l.offsetY;}else{if(typeof f.fn.offset=="function"){var m=h.offset();i.clk_x=l.pageX-m.left;i.clk_y=l.pageY-m.top;}else{i.clk_x=l.pageX-k.offsetLeft;i.clk_y=l.pageY-k.offsetTop;}}}setTimeout(function(){i.clk=i.clk_x=i.clk_y=null;},100);}f.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin click.form-plugin");
};f.fn.formToArray=function(x,g){var w=[];if(this.length===0){return w;}var l=this[0];var p=x?l.getElementsByTagName("*"):l.elements;if(!p){return w;}var r,q,o,y,m,t,k;for(r=0,t=p.length;r<t;r++){m=p[r];o=m.name;if(!o||m.disabled){continue;}if(x&&l.clk&&m.type=="image"){if(l.clk==m){w.push({name:o,value:f(m).val(),type:m.type});
w.push({name:o+".x",value:l.clk_x},{name:o+".y",value:l.clk_y});}continue;}y=f.fieldValue(m,true);if(y&&y.constructor==Array){if(g){g.push(m);}for(q=0,k=y.length;q<k;q++){w.push({name:o,value:y[q]});}}else{if(c.fileapi&&m.type=="file"){if(g){g.push(m);}var h=m.files;if(h.length){for(q=0;q<h.length;q++){w.push({name:o,value:h[q],type:m.type});
}}else{w.push({name:o,value:"",type:m.type});}}else{if(y!==null&&typeof y!="undefined"){if(g){g.push(m);}w.push({name:o,value:y,type:m.type,required:m.required});}}}}if(!x&&l.clk){var s=f(l.clk),u=s[0];o=u.name;if(o&&!u.disabled&&u.type=="image"){w.push({name:o,value:s.val()});w.push({name:o+".x",value:l.clk_x},{name:o+".y",value:l.clk_y});
}}return w;};f.fn.formSerialize=function(g){return f.param(this.formToArray(g));};f.fn.fieldSerialize=function(h){var g=[];this.each(function(){var o=this.name;if(!o){return;}var l=f.fieldValue(this,h);if(l&&l.constructor==Array){for(var m=0,k=l.length;m<k;m++){g.push({name:o,value:l[m]});}}else{if(l!==null&&typeof l!="undefined"){g.push({name:this.name,value:l});
}}});return f.param(g);};f.fn.fieldValue=function(n){for(var m=[],k=0,g=this.length;k<g;k++){var l=this[k];var h=f.fieldValue(l,n);if(h===null||typeof h=="undefined"||(h.constructor==Array&&!h.length)){continue;}if(h.constructor==Array){f.merge(m,h);}else{m.push(h);}}return m;};f.fieldValue=function(g,p){var k=g.name,w=g.type,x=g.tagName.toLowerCase();
if(p===undefined){p=true;}if(p&&(!k||g.disabled||w=="reset"||w=="button"||(w=="checkbox"||w=="radio")&&!g.checked||(w=="submit"||w=="image")&&g.form&&g.form.clk!=g||x=="select"&&g.selectedIndex==-1)){return null;}if(x=="select"){var q=g.selectedIndex;if(q<0){return null;}var s=[],h=g.options;var m=(w=="select-one");
var r=(m?q+1:h.length);for(var l=(m?q:0);l<r;l++){var o=h[l];if(o.selected){var u=o.value;if(!u){u=(o.attributes&&o.attributes["value"]&&!(o.attributes["value"].specified))?o.text:o.value;}if(m){return u;}s.push(u);}}return s;}return f(g).val();};f.fn.clearForm=function(g){return this.each(function(){f("input,select,textarea",this).clearFields(g);
});};f.fn.clearFields=f.fn.clearInputs=function(g){var h=/^(?:color|date|datetime|email|month|number|password|range|search|tel|text|time|url|week)$/i;return this.each(function(){var k=this.type,i=this.tagName.toLowerCase();if(h.test(k)||i=="textarea"){this.value="";}else{if(k=="checkbox"||k=="radio"){this.checked=false;
}else{if(i=="select"){this.selectedIndex=-1;}else{if(k=="file"){if(/MSIE/.test(navigator.userAgent)){f(this).replaceWith(f(this).clone(true));}else{f(this).val("");}}else{if(g){if((g===true&&/hidden/.test(k))||(typeof g=="string"&&f(this).is(g))){this.value="";}}}}}}});};f.fn.resetForm=function(){return this.each(function(){if(typeof this.reset=="function"||(typeof this.reset=="object"&&!this.reset.nodeType)){this.reset();
}});};f.fn.enable=function(g){if(g===undefined){g=true;}return this.each(function(){this.disabled=!g;});};f.fn.selected=function(g){if(g===undefined){g=true;}return this.each(function(){var h=this.type;if(h=="checkbox"||h=="radio"){this.checked=g;}else{if(this.tagName.toLowerCase()=="option"){var i=f(this).parent("select");
if(g&&i[0]&&i[0].type=="select-one"){i.find("option").selected(false);}this.selected=g;}}});};f.fn.ajaxSubmit.debug=false;function d(){if(!f.fn.ajaxSubmit.debug){return;}var g="[jquery.form] "+Array.prototype.join.call(arguments,"");if(window.console&&window.console.log){window.console.log(g);}else{if(window.opera&&window.opera.postError){window.opera.postError(g);
}}}})(jQuery);var philLib=function(){var a=this.phil=function(b){if(window.my&&my.id){var c=$("#"+my.id);}if(c){return b?$("#"+my.id).find(b):$("#"+my.id);}else{return $(b);}};a._paths={"phil":"../templates/phil",};a.pathFor=function(b){var g=b.split("/");var f=a._paths[g[0]];if(!f){return undefined;
}var c=[f];for(var e=1;e<g.length;e++){c.push("/"+g[e]);}var d={"js":c.join("")+".js","css":c.join("")+".css","html":c.join("")+".html"};return d;};a.stopPropagation=function(b){console.log("WARNING: phil.stopPropagation");b=b||window.event;if(b.stopPropagation){b.stopPropagation();}else{b.cancelBubble=true;
}};a.cards={};a.cache={};a.tmpl=function(d,c){console.log("WARNING: phil.tmpl");var b;var e=!/\W/.test(d);if(e){b=a.cache[d];if(!b){b=a.tmpl(c);c=undefined;a.cache[d]=b;}else{if(a.isString(c)){c=undefined;}}}else{if(!d.replace){console.log("Error with phil.tmpl ["+d+"]["+c+"]");}b=new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};"+"with(obj){p.push('"+d.replace(/[\r\t\n]/g," ").split("<%").join("\t").replace(/((^|%>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%>/g,"',$1,'").split("\t").join("');").split("%>").join("p.push('").split("\r").join("\\'")+"');}return p.join('');");
}return c?b(c):b;};a.tmplCard=function(c){console.log("WARNING: phil.tmplCard");c=c||{};var d="card-default";var b="card-"+c.cardType;if(c.cardType){if($("#"+b).length>=1){d=b;}}return d;};a.feature=function(c){isEl=isEl||false;var e=document.createElement("detect");var b=false;for(var d=0;d<c.length;
d++){if(e.style[c[d]]==""){b=true;break;}}return b;};a.bind=function(d,c){if(c){var b=$("#"+c)[0];ko.applyBindings(d,b);}else{var b=$("body")[0];ko.applyBindings(d);}if(d._ready){d._ready(true);}};a.hexify=function(e){var b=[];for(var d=0;d<e.length;d++){var c=e[d].charCodeAt();b.push((c-65)*4.473);}return b;
};a.unbind=function(c){console.log("WARNING: phil.unbind");if(c){var b=$("#"+c)[0];ko.cleanNode(b);}else{var b=$("body")[0];ko.cleanNode(b);}};a.isObject=the.isObject;a.isArray=the.isArray;a.isBool=the.isBool;a.isFunc=the.isFunc;a.isString=the.isString;a.data=function(g){var c=g.attr("data-phil");var h=c?c.split(","):"";
var f={};for(var e=0;e<h.length;e++){var b=h[e].split(":");var d=b[0];var k=b[1];f[d]={key:d,val:k};}return f;};a.compute=ko.computed;a.isObservable=ko.isObservable;a.unwrap=ko.utils.unwrapObservable;a.observe=function(b){if(a.isArray(b)){return ko.observableArray(b);}else{return ko.observable(b);}};
a.observePausable=function(b){if(a.isArray(b)){return ko.pausableObservableArray(b);}};a.observeBunch=function(b){if(a.isArray(b)){return ko.pausableObservableArray(b);}};a.parse=function(d){var b=d.replace(/>[\s]+</g,"><");var c=b.replace("</scr","</scr");var e=$(a.Html.parse(c,false));return e;};a.toJson=function(b){return ko.toJSON(b);
};a.toJs=function(c){var b=ko.toJS(c);return b;};ko.pausableObservableArray=function(c){var b=ko.observableArray(c);b["_paused"]=false;b.pause=function(){this._paused=true;return b.peek();}.bind(b);b.resume=function(){this._paused=false;this.valueHasMutated();}.bind(b);b.push=function(d){var f=this.peek();
var e=f.push.apply(f,arguments);return e;}.bind(b);return b;};a.markupify=function(h){if(!h||!a.isString(h)){return h;}var l=h;function i(r,p,o,q,n){return"<h1>"+p+"</h1>";}function g(r,p,o,q,n){return"<h2>"+p+"</h2>";}function e(r,p,o,q,n){return"<h3>"+p+"</h3>";}function k(u,s,r,q,p,t,o){var n="";if(s==="__"&&p==="__"){n=" class='is-underline'";
}return"<em"+n+">"+r+"</em>";}function d(u,s,r,q,p,t,o){var n="";if(s==="__"&&p==="__"){n=" class='is-underline'";}return"<strong"+n+">"+r+"</strong>";}function f(r,p,o,q,n){return"<del>"+p+"</del>";}function c(r,p,o,q,n){return'<a href="'+o+'" target="_blank">'+p+"</a>";}function b(r,p,o,q,n){return'<img src="'+o+'">'+p+"</img>";
}function m(s,q,p,r,n){var o=s.substring(8,s.length-8);o=o.replace(/ \* ([\w _\-\*\/\?\!\+\=\,\.]*)(<br>){0,1}/g,function(v,u,t,x,w){return"<li>"+u+"</li>";});return"<ul>"+o+"</ul>";}l=l.replace(/(\r\n|\r|\n)/g,"<br>");l=l.replace(/(<br>){2}( \* [\w \,\.\(\)\?\!\/\*\=\'_-]*<br>)*(<br>){1}/g,m);l=l.replace(/[#]{3} ([\w ]*)(<br>){1}/g,e);
l=l.replace(/[#]{2} ([\w ]*)(<br>){1}/g,g);l=l.replace(/[#]{1} ([\w ]*)(<br>){1}/g,i);l=l.replace(/[~]{2}(.*?)[~]{2}/g,f);l=l.replace(/([_]{0,2})[\*]{2}([\w\d]([\w \:\,\.\_\-\?\(\)]*))[\*]{2}([_]{0,2})/g,d);l=l.replace(/([_]{0,2})[\*]{1}([\w\d]([\w \:\,\.\_\-\?\(\)]*))[\*]{1}([_]{0,2})/g,k);l=l.replace(/![\[]{1}(.*?)[\]]{1}[(]{1}(.*?)[)]{1}/g,b);
l=l.replace(/[\[]{1}(.*?)[\]]{1}[(]{1}(.*?)[)]{1}/g,c);return l;};a.injectTmpl=function(c,d){var b=document.getElementById(c);if(!b){$("body").prepend('<script type="text/tmpl" id="'+c+'">'+d+"<\/script>");}};a.insertTmpl=function(c){var b=document.getElementById(c);if(!b){return"";}return b.innerHTML;
};a.toFixed=function(f,b){var b=b||0,h=f<0,d=Math.pow(10,b),f=Math.round(f*d),e=String((h?Math.ceil:Math.floor)(f/d)),c=String((h?-f:f)%d),g=new Array(Math.max(b-c.length,0)+1).join("0");return b?e+"."+g+c:e;};a.htmlEncode=function(b){if(!b||b===null){return b;}if(!b.replace){b=b.toString();}return b.replace(/(\n)/g,"<br>");
};a.escape=function(c){if(!c||!a.isString(c)){return c;}var b={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#47;"};if(!c.replace){return c;}var d=c.replace(/[&<>"'\/]/g,function(e){return b[e];});return d;};a.unescape=function(c){var b={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'","&#47;":"/"};
var d=c.replace(/(&amp;|&lt;|&gt;|&quot;|&#39;|&#47;)/g,function(e){return b[e];});return d;};a.unencode=function(c){console.log("WARNING: phil.unencode");var f={"%2E":".","%3A":":","%27":"'","%22":'"'};if(!a._unencodeRegex){var b=[];for(var d in f){if(b.length>0){b.push("|");}b.push("(");b.push(d);b.push(")");
}a._unencodeRegex=new RegExp(b.join(""),"g");}var e=c.replace(a._unencodeRegex,function(g){return f[g];});return e;};a.resolveComments=function(c){console.log("WARNING: phil.resolveComments");var d=0;MODULE=1;ACTION=2;NAME=3;var f=/(?:<!--\W+)(pumpco\W+)([a-z]+)(?::)([a-z\-]+\W+)(?:-->)/g;function e(k){var n=k[NAME].trim();
var m=ko.bindingHandlers[n];var l=ko.bindingHandlers[n].tmpl();if(l){var h=k.index+k[d].length;var o=c.substring(0,k.index);var g=c.substring(h);var i=l;c=o+i+g;}}var b;while((b=f.exec(c))!==null){if(b[ACTION]==="widget"){e(b);}}return c;};a._widget=function(f,i){var m=0;MODULE=1;ACTION=2;NAME=3;var c=f[NAME].trim();
var h=ko.bindingHandlers[c];var k=ko.bindingHandlers[c].tmpl();var e=i.innerHTML;if(k){var l=f.index+f[m].length;var b=e.substring(0,f.index);var d=e.substring(l);var n=k;var g=!the.cssFeature(["webkitBoxFlex","MozBoxFlex","msFlex"]);if(!g){i.innerHTML=b+n+d;}else{i.text=b+n+d;}}};a.resolveHtml=function(){var m=0;
MODULE=1;ACTION=2;NAME=3;var e=/(?:<!--\W+)(pumpco\W+)([a-z]+)(?::)([a-z\-]+\W+)(?:-->)/g;var d=a("script");for(var f=0;f<d.length;f++){var k=d[f];var g;while((g=e.exec(k.innerHTML))!==null){if(g[ACTION]==="mixin"){var n=a("#"+g[NAME])[0];if(n){var l=g.index+g[m].length;var b=k.innerHTML.substring(0,g.index);
var c=k.innerHTML.substring(l);var o=n.innerHTML;var h=!the.cssFeature(["webkitBoxFlex","MozBoxFlex","msFlex"]);if(!h){k.innerHTML=b+o+c;}else{k.text=b+o+c;}}}if(g[ACTION]==="widget"){a._widget(g,k);}}}};a.printf=function(e){function d(f,g){if(typeof c[g]!="undefined"){return c[g];}else{return f;}}var c=Array.prototype.slice.call(arguments,1);
var b=e.replace(/{(\d+)}/g,d);return b;};a.hasTouchEvents=false;if("ontouchstart" in window){a.hasTouchEvents=true;}else{if(window.navigator.msPointerEnabled){a.hasTouchEvents=true;}}};(function(){philLib();})();(function(a){a.Events=function(b){var c={};c._listeners={};c.listen=function(d,e){c._listeners[d]=c._listeners[d]||[];
c._listeners[d][c._listeners[d].length]=e;};c.trigger=function(d,f){if(c._listeners[d]){for(var e=0;e<c._listeners[d].length;e++){c._listeners[d][e].call(c,f);}}};return c;}();})(__ns("phil"));(function(){phil["goTo"]=function(b,a){var c=b?$("#"+b):$("body")[0];c.find(".screen").removeClass("displayed").addClass("concealed");
c.find(".screen[name="+a+"]").removeClass("concealed").addClass("displayed");$.event.trigger({type:"screenShow",message:a,time:new Date()});};phil["reveal"]=function(g,b){var a=g?$("#"+g):$("body")[0];var e=a.find(".screen[name=home]");var d=a.find(".screen[name="+b+"]");if(d.hasClass("concealed")){d.removeClass("concealed").addClass("displayed");
var c=e.position();var f=d.position();var h=f.top-c.top;vDiffString="-"+h+"px";d.css({top:vDiffString});$.event.trigger({type:"screenShow",message:b,time:new Date()});}else{d.css({top:"0px"});setTimeout(function(){d.removeClass("displayed").addClass("concealed");},500);}};phil["panelIsDual"]=function(b){var a={visible:[],hidden:[]};
b.each(function(){var c=$(this).css("visibility");if(c==="visible"){a.visible.push($(this));}else{a.hidden.push($(this));}});a.test=a.hidden.length===0?true:false;return a;};phil["cssAnimate"]=function(a,b,c){a.addClass(b).one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",c);
};phil["cssAnimateSlide"]=function(a,d,b){if(d==="in"){for(var c=0;c<b.visible.length;c++){b.visible[c].addClass("panel-pre-hidden");}phil.cssAnimate(a,"animated slideInRight",function(e){$(this).removeClass("animated slideInRight").removeClass("panel-hidden").addClass("panel-shown");for(var f=0;f<b.visible.length;
f++){b.visible[f].removeClass("panel-pre-hidden panel-shown").addClass("panel-hidden");}for(var f=0;f<b.hidden.length;f++){b.hidden[f].removeClass("panel-pre-hidden").addClass("panel-hidden");}});}else{a.removeClass("panel-hidden").addClass("panel-pre-hidden ");phil.cssAnimate(b.visible[0],"animated slideOutRight",function(e){$(this).removeClass("animated slideOutRight").removeClass("panel-shown").addClass("panel-hidden");
a.removeClass("panel-pre-hidden").removeClass("panel-hidden").addClass("panel-shown");});}};phil["panelChange"]=function(e,a,d){d=d||"in";var g=e?$("#"+e):$("body")[0];var c=g.find(".panel");var b=phil.panelIsDual(c);if(b.test===true){return -1;}var f=g.find(".panel[name="+a+"]");phil.cssAnimateSlide(f,d,b);
f.removeClass("panel-hidden").addClass("panel-shown");$.event.trigger({type:"panelShow",message:a,time:new Date()});};phil["panelNext"]=function(b,a){phil.panelChange(b,a,"in");};phil["panelPrev"]=function(b,a){phil.panelChange(b,a,"out");};phil["attachUiHandlers"]=function(a){var b=a?$("#"+a):$("body")[0];
b.find("[data-ui-show]").click(function(){phil.goTo(a,$(this).data("ui-show"));});b.find("[data-ui-reveal]").click(function(){phil.reveal(a,$(this).data("ui-reveal"));});b.find("[data-panel-next]").click(function(){phil.panelNext(a,$(this).data("panel-next"));});b.find("[data-panel-prev]").click(function(){phil.panelPrev(a,$(this).data("panel-prev"));
});};})();ko.bindingHandlers.fileUpload={init:function(c,e,b,g,d){var k=ko.utils.unwrapObservable(e()),h=ko.utils.unwrapObservable(k.property),a=ko.utils.unwrapObservable(k.url);var i=$(c);var f=i.find("input");i.ajaxForm();f.change(function(){var m=f.val();var l=m.replace(/C:\\fakepath\\/,"");i.ajaxSubmit({iframe:true,type:"POST",headers:{},beforeSubmit:function(p,o,n){return true;
},success:function(n){k.property(n);},error:function(n,p,o){k.property(n.responseText);}});});},update:function(c,d,e,b,a){}};ko.bindingHandlers.internal={update:function(b,c,e,a){var d=$(b).data("widget");if(!d){return -1;}d._value=c();}};ko.bindingHandlers.typeahead={init:function(d,f,c,k,e){var l=$(d);
var h=ko.utils.unwrapObservable(f());var g=phil.data(l);var m=false;if(g["txtToken"]){m=true;}var a=false;var i=l.attr("data-bind");if(i){a=true;}l.attr("autocomplete","off").typeahead({"source":h,"tokenised":m,"knockout":a});var b=l.parent();if(b.hasClass("txt-prepend")||b.hasClass("txt-append")){b.find("button").click(function(n){l.data("widget").showMenu();
});}}};(function(a){a.Model=function(){var b={};b._ready=phil.observe(false);b._i18n={};b.i18nLoad=function(d){if(!d){return -1;}for(var c in d){b._i18n[c]=d[c];}};return b;};phil.cards["contact"]=function(i){var h=h||this;function f(n){if(!n){return"";}var l="";if(n["street-address"]){for(var m=0;m<n["street-address"].length;
m++){l+=n["street-address"][m]+" ";}}else{l+=n["address1"]?n["address1"]+" ":"";l+=n["address2"]?n["address2"]+" ":"";l+=n["address3"]?n["address3"]+" ":"";}l+=n["locality"]?n["locality"]+" ":"";l+=n["region"]?n["region"]+" ":"";if(n["postal-code"]){l+=n["postal-code"]?n["postal-code"]+" ":"";}else{l+=n["postcode"]?n["postcode"]+" ":"";
}return phil.escape(l);}function k(o){if(!o){return[];}var n=[];for(var p=0;p<o.length;p++){var l=o[p].type.length>0?o[p].type[0]:"";if(l.indexOf("system")===-1){var m=o[p].value;n.push(phil.escape(m));}}return phil.escape(n);}function g(n){if(!n){return[];}var m=[];for(var o=0;o<n.length;o++){var l=n[o].type.length>0?" ( "+n[o].type[0]+" )":"";
var p=n[o].value+l;m.push({"display":phil.escape(p),"tel":"tel:"+n[o].value});}return m;}function d(l){if(!l){return[];}var m=[];for(var n=0;n<l.length;n++){m.push(phil.escape(l[n].label));}return m;}function b(l){if(!l){return"";}if(l.nickname&&l.nickname!==""){return l.nickname;}if(l.n&&l.n["given-name"]&&l.n["family-name"]){return phil.printf("{0}, {1}",l.n["family-name"].toUpperCase(),l.n["given-name"]);
}if(l.fn){return l.fn;}if(l.label){return l.label;}return"";}function e(n){if(n===undefined||n===""){return"";}var m=Date.today();var l=Date.parseExact(n,"yyyy-MM-dd");var o=new TimeSpan(m-l);if(o.days===0){return"last logged in today";}else{return"last logged in "+o.days+"d(s) ago";}}var c=phil.cards["Base"].call(h,i);
c.fadr=phil.observe(f(i.adr));c.bday=i.bday;c.email=phil.observe(k(i.email));c.fn=i.fn;c.label=phil.observe(b(i));c.link=i.link;c.nickname=phil.observe(i.nickname||i.fn);c.photo=phil.observe(i[i.mappings.photo]);c.tel=phil.observe(g(i.tel));c.type=i.type||"";c.uid=i.uid||undefined;c.username=i.username||undefined;
c.relation=phil.observe(d(i.relationship));c.lastLogin=phil.observe(e(i.lastLogin));c.update=function(l){c.fadr(f(l.adr));c.email(k(l.email));c.label(b(l));c.nickname(l.nickname||l.fn);c.photo(l[l.mappings.photo]);c.tel(g(l.tel));c.lastLogin(e(l.lastLogin));};return c;};a.model=function(c){var b={};b.ISOK=1;
b.ISNEUTRAL=0;b.ISWARNING=-1;b.ISERROR=-2;b.Element=function(f){var e={};var d=f;if(!d||!phil.isObject(d)){d={};d.value=f||"";}e.enabled=phil.observe(d.enabled||true);e.hidden=phil.observe(d.hidden||false);e.id=d.id||"";e.name=d.name||"";e.status=phil.observe(d.status||0);e.value=phil.observe(d.value);
e.focus=phil.observe(false);e.subscribe=function(g){this.value.subscribe(g);}.bind(e);e.propagateEvent=function(k){var h=k.target||k.srcElement;var g=h.name;if(!g){g=h.dataset.name;}var i=e._on[g];if(i){k.preventDefault();k.stopPropagation();var l=ko.dataFor(h);i.fn.call(i.scope,k,l);}};e._on={};e.on=function(i,h,g){g=g||this;
e._on[i]={"el":i,"fn":h,"scope":g};};e.toJSON=function(){return{"id":e.id,"name":e.name,"value":e.value()};};return e;};b.Button=function(e){var d=b.Input(e);__mixin(d,new phil.mixins.Observable());d.handler=e.handler||undefined;d.auto=e.auto||false;return d;};b.ButtonMenu=function(e){var d={};d.button=b.Button(e.button||{});
d.button["onmenushow"]=e.button.onmenushow||function(){};d.menu=b.Menu(e.menu||{});return d;};b.ContactList=function(g){g=g||{};var f=b.Element(g);var e=g.sort!==undefined?g.sort:true;var l=g.id||"id";var d=g.multi?2:1;f.size=g.size?"-"+g.size:"";for(var h=0;h<g.buttons;h++){card[g.buttons[h].name]=b.Button(g.buttons[h]);
}__mixin(f,phil.model.Hash({"select":d}));f.listen("precard",function(m){var i=m.spec;if(!i.id){i.id=i[l];}if(i.type!=="user"){i.type="contact";}i.cardType="contact";i.mappings={"label":g.label||"label","photo":g.photo||"photo"};});if(e===true){f.sortFn(function(o,m){var i=o.label().toLowerCase();var n=m.label().toLowerCase();
return i==n?0:(i<n?-1:1);});}function k(i){if(i.type==="user"){return true;}else{return false;}}f.isFiltered=phil.observe(false);f.filterFn(function(){});f.filter=function(i){f.isFiltered(i);if(f.isFiltered()===false){f.filterFn(function(){});}else{f.filterFn(k);}f.data.valueHasMutated();};return f;};
b.Date=function(e){var d=b.Input(e);return d;};b.FileUpload=function(e){var d=b.Input(e);return d;};b.Graph=function(e){e=e||{};var d=b.Element(e);d.type=e.type||"chart";d.height=e.height||160;d.width=e.width||160;d.options=e.options||{};return d;};b.DiabetesGraph=function(e){e=e||{};var d=b.Graph(e);
d.type="diabeteschart";return d;};b.Heading=function(e){var d=b.Element(e);return d;};b.Input=function(e){var d=b.Element(e);d.errorMsg=phil.observe(e.errorMsg||undefined);d.placeholder=phil.observe(e.placeholder||"");d.capture=e.capture||false;d.keydown=e.keydown||function(){};if(e.validator){d.value.extend({"validate":function(f){e.validator.call(this,d,f);
}});}return d;};b.Label=function(f){var e={};var d=f;if(!d||!phil.isObject(d)){d={};d.value=f||"";}e.value=phil.observe(d.value);e.hidden=phil.observe(d.hidden||false);return e;};b.Menu=function(e){var d={};d.items=phil.observe(e.items||[]);d.each=function(g){for(var f=0;f<d.items().length;f++){var h=d.items()[f];
g(h);}};return d;};b.Paragraph=function(e){var d=b.Element(e);return d;};b.Progress=function(e){var d=b.Element(e);d.progress=phil.observe(e.progress||0);return d;};b.Select=function(e){var d=b.Input(e);d.options=phil.observe(e.options||[]);d.options.extend({escapearray:true});return d;};b.Textarea=function(e){var d=b.Input(e);
return d;};b.Time=function(e){var d=b.Input(e);d.value(the.formatTime(Date.today().setTimeToNow()));return d;};return b;}();})(phil);(function(b,d){var c=new b.nativeTemplateEngine();var a={};b.templateSources.requireTemplate=function(e){this.key=e;this.template=b.observable(" ");this.requested=false;
this.retrieved=false;};b.templateSources.requireTemplate.prototype.text=function(e){if(!this.requested&&this.key){$.ajax({url:this.key,context:this}).done(function(g,h,f){this.retrieved=true;this.template(g);}).fail(function(f,h,g){this.retrieved=false;console.log("phil-async-engine: Template not found");
});this.requested=true;}if(!this.key){this.template("");}if(arguments.length===0){return this.template();}};c.makeTemplateSource=function(f,g){var e;if(typeof f==="string"){e=(g||document).getElementById(f);if(e&&e.tagName.toLowerCase()==="script"){return new b.templateSources.domElement(e);}if(!(f in a)){a[f]=new b.templateSources.requireTemplate(f);
}return a[f];}else{if(f&&(f.nodeType===1||f.nodeType===8)){return new b.templateSources.anonymousTemplate(f);}}};b.setTemplateEngine(c);}(ko,jQuery));(function(a){a.Observable=function(b){b=b||{};var c={};c._listeners={};c._bubbles=b.bubbles||true;c.listen=function(d,e){c._listeners[d]=this._listeners[d]||[];
c._listeners[d][this._listeners[d].length]=e;return this;};c.trigger=function(f,l,d){if(c._listeners[f]||c._listeners["*"]){var h=c._listeners[f];var k=false;if(!h){h=c._listeners["*"];k=true;}for(var g=0;g<h.length;g++){if(k){var e=Array.prototype.slice.call(arguments,0);h[g].apply(this,e);}else{var e=Array.prototype.slice.call(arguments,1);
h[g].apply(this,e);}}}else{if(this._parent&&this._bubbles){this._parent.trigger(f,l);}}};return c;};})(__ns("phil.mixins"));(function(a){a.Selectable=function(b){b=b||{};var c={};c._selected=phil.observe(false);c.select=function(){this._selected(!this._selected());};return c;};})(__ns("phil.mixins"));
(function(a){a.Observable=function(b){var c={};c._listeners={};c.listen=function(d,e){c._listeners[d]=this._listeners[d]||[];c._listeners[d][this._listeners[d].length]=e;};c.trigger=function(d,f){if(c._listeners[d]){for(var e=0;e<c._listeners[d].length;e++){c._listeners[d][e].call(this,f);}}};return c;
};a.Bag=function(b){b=b||{};var c={};__mixin(c,a.Observable());c["_name"]=b.name;c.standardise=b.standardise||function(e){return e;};c.loaded=b.loaded||function(){c.trigger("loaded",{});};var d=!the.cssFeature(["borderRadius"]);c.performance=b.legacy||d?{"batch":20,"delay":10}:{"batch":50,"delay":0};
c.sorterFn=b.sortBy||undefined;c.el=b.el||{};c.data=phil.observePausable([]);c.createCard=function(e,f,h){var g=e.call(h,f);return g;};c.addCard=function(f,i){if(!f.cardType){if(!f.type){the.log.error(this,"Cannot add card without a type. Invalid Card structure.");return -1;}else{f.cardType=f.type;}}var e=phil.cards[f.cardType]||phil.cards["Base"];
var g=undefined;try{g=c.createCard(e,f,i);c.insert(g);}catch(h){the.log.error("Bundle","Error creating card ["+h.message+"]");}return g;};c.refreshCard=function(e,g){if(!e.cardType){if(!e.type){the.log.error(this,"Cannot add card without a type. Invalid Card structure.");return -1;}else{e.cardType=e.type;
}}var f=c.data()[g];f.update(e,"baselined");};c.addIfNot=function(e){var k=false;var f=c.data();for(var h=0;h<f.length;h++){var g=f[h];if(g.id===e.id){k=true;break;}}if(!k){c.push([e]);}};c.checkIf=function(k){var l=-1;var f=c.data();for(var h=0;h<f.length;h++){var g=f[h];var e=k(g);if(e>=0){l=h;break;
}}return l;};c.clear=function(){c.data.splice(0,c.data().length);};c.getById=function(h){var f=h;var e=c.checkIf(function g(i){if(i.id===f){return 0;}return -1;});if(e>=0){return c.data()[e];}else{undefined;}};c.delIf=function(h){if(!h){return;}var e=c.data();for(var g=0;g<e.length;g++){var f=e[g];if(f.id===h.id){c.data.splice(g,1);
break;}}};c.name=phil.observe("card-href");c.expansion=phil.observe(1);c.each=function(g){var e=c.data();for(var f=0;f<e.length;f++){g.call(this,e[f]);}};c.getSelected=function(){var e=[];c.each(function(f){if(f.oSelected()){e.push(f);}});return e;};c.insert=function(f,e){e=e||c.data().length;f._parentTrigger=c.trigger;
c.data().splice(e,0,f);};c.load=function(f,e){e=e||{};e.refresh=e.refresh||false;e.deletemissing=e.deletemissing||false;e.callback=e.callback||undefined;c.pause();if(e.refresh){host.data([]);}__.each2(f,function(g,h,i){c.trigger("precard",{"spec":g});var h=c.checkIf(function(k){if(k.id===g.id){return 0;
}return -1;});if(h===-1){c.addCard(g);}else{c.refreshCard(g,h);}},function(g){c.resume();if(!g){if(e.callback){e.callback();}c.loaded();}},c.performance);};c.loadSync=function(e,f){c.load(e,{"callback":f});};c.tmpl=function(f){var e="card-"+f.cardType;if($("#"+e).length>=1){return e;}else{return"card-default";
}};c.pause=function(){c.data.pause();};c.resume=function(){c.data.resume();};c.push=function(f){for(var e=0;e<f.length;e++){c.data.push(f[e]);}};c.splice=function(f,g,e){c.data.splice(f,g,e);};c.isEmpty=function(){return c.data().length===0?true:false;};return c;};})(__ns("phil.model"));(function(a){a.Set=function(b){b=b||{};
var c=__clone(a.Bag(b));c._select=b.select||0;c._super.createCard=function(d,e,g){var f=d.call(g,e);if(c._select>0){f.listen("selected",function(i,h){if(c._select===1){c.unselectAll(h.id);}c.trigger("selection",h,i);});}return f;};c.select=function(d){if(d){c._select=d;}return c._select;};c.unselectAll=function(f){var d=c.data();
for(var e=0;e<d.length;e++){if(d[e].id!==f){d[e].oSelected(false);}}};return c;};})(__ns("phil.model"));(function(a){a.Hash=function(b){b=b||{};var c=__clone(a.Set(b));c.filterFn=phil.observe(undefined);c.sortFn=phil.observe(undefined);c.filtered=ko.computed(function(){var d;var e=c.data();if(c.sortFn()){e=e.sort(c.sortFn());
}if(c.filterFn()){__.each2(e,function(g,f,k){var h=c.filterFn();var i=h(g);g.oVisible(i);},function(f){},c.performance);}return e;},this);return c;};})(__ns("phil.model"));(function(a){a.Tree=function(b){b=b||{"type":"root","name":"root"};var c=this;c.empty=phil.observe(true);c.data=new a.Nodes(b);c.data.listen("node.push",function(){this.empty(false);
}.bind(this));return c;};a.Tree.prototype={};a.Tree.prototype.add=function(b){};a.Tree.prototype.del=function(c){var b=this.data.deepFind(c);b.parent.del(c);};a.Tree.prototype.clear=function(){this.data.clear();};a.Tree.prototype.isEmpty=function(){return this.empty();};a.Tree.prototype.createCard=function(c,d,f){f=f||c.card;
var b=phil.cards[f];if(!b){b=phil.cards.Generic;}var e=new b(c);return e;};a.Tree.prototype.createNode=function(b,c){if(b["object"].card){var d=new a.Nodes(b,["object"]);c.push(d);this.load([b["object"]],d);}else{var d=new a.Nodes(b);c.push(d);}};a.Tree.prototype.load=function(d,f){this.data.pause();
if(!f){f=this.data;f.apply(d,["entries"]);d=d.entries;}for(var c=0;c<d.length;c++){var b=d[c];if(b.card){var e=this.createCard.call(this,b,f);this.load(b.properties,f);}else{this.createNode.call(this,b,f);}}this.data.resume();};a.Tree.prototype.listen=function(b,c){this.data.listen(b,c);};})(__ns("phil.model"));
(function(a){a.Nodes=function(b,e){b=b||{};var c=this;var d=this;__mixin(c,new phil.mixins.Observable());c._supports=[];c._supportMap={};c.autoSupport=false;c._children=phil.observe([]);c._parent=undefined;c.apply.call(c,b,e);return c;};a.Nodes.prototype={};a.Nodes.prototype.apply=function(b,e){var d=this;
for(var c in b){if($.inArray(c,e)===-1){d[c]=b[c];}}};a.Nodes.prototype.add=function(c,b){if(c.name&&this.autoSupport){this.supports(c.name);}this.addParent(c,this);this._children.push(c);};a.Nodes.prototype.del=function(c){var b=-1;this._each(function(e,d){if(e.id===c){b=d;}});if(b>-1){this._children.splice(b,1);
}};a.Nodes.prototype.addParent=function(c,b){c._parent={"name":b.name,"trigger":function(){b.trigger.apply(b,arguments);}};if(b.label){c._parent.label=phil.isFunc(b.label)?b.label():b.label;}};a.Nodes.prototype.clear=function(){this._children.removeAll();};a.Nodes.prototype.deepFind=function(g){var b={"card":undefined,"parent":this};
var e=this._children;if(the.isFunc(e)){e=e();}for(var d=0;d<e.length;d++){var f=e[d];if(f.id===g){b.card=f;break;}if(f.deepFind){var c=f.deepFind(g);if(c.card){b=c;}}}return b;};a.Nodes.prototype._each=function(e){var c=this._children;if(the.isFunc(c)){c=c();}for(var b=0;b<c.length;b++){var d=c[b];e(d,b);
}};a.Nodes.prototype.childrenToJs=function(c){var b=[];this._each.call(this,function(d){b.push({"name":d.name,"value":d.value?d.value():undefined});});return b;};a.Nodes.prototype.findById=function(c){var b=undefined;this._each.call(this,function(d){if(d.id===c){b=d;}});return b;};a.Nodes.prototype.findByKey=function(c,d){var b=undefined;
this._each.call(this,function(f){var e=__get(c,f);if(e===d){b=f;}});return b;};a.Nodes.prototype.findByName=function(c){var b=[];this._each.call(this,function(d){if(d.name===c){b.push(d);}});return b;};a.Nodes.prototype.push=function(d,b){var c=b||this.autoSupport;if(d._children().length===0&&c){this.supports(d.name);
}if(d.name&&$.inArray(d.name,this._supports)>-1){var e=phil.model.TypeMapper.resolve(d);if(e){this._children.push(e);}else{this.addParent(d,this);this._children.push(d);}}else{this.addParent(d,this);this._children.push(d);}this.trigger("node.push",d);};a.Nodes.prototype.supports=function(){for(var b=0;
b<arguments.length;b++){var c=arguments[b];this._supports.splice(this._supports.length,0,c);this._supportMap[c]=b;}};a.Nodes.prototype.getProperty=function(c){var b=this._supportMap[c];if(b!==undefined){var d=this._children()[b];return d;}else{return undefined;}};a.Nodes.prototype.updateSupported=function(d){if(d.name&&$.inArray(d.name,this._supports)>-1){var b=undefined;
for(var c=0;c<this._children().length;c++){var e=this._children()[c];if(e.name===d.name){phil.model.TypeMapper.update(d,e);break;}}}};a.Nodes.prototype.pause=function(){};a.Nodes.prototype.resume=function(){};a.Nodes.prototype.hasChildren=function(){var b=this._children.peek();return b.length>0?true:false;
};a.Nodes.prototype.size=function(){var b=this._children.peek();return b.length;};})(__ns("phil.model"));(function(a){a.Book=function(b){b=b||{};var c=this;c.afterRender=b.afterRender||function(){};c.collapsible=b.collapsible||false;this.data=new phil.books.Book({"book":"root","version":1,"label":"","description":"","photo":""});
return c;};a.Book.requiredCards=function(f){var g=[];if(f.card){g.push(f.card);}for(var d in f){var e=f[d];if(the.isObject(e)||the.isArray(e)){var c=a.Book.requiredCards(e);if(c.length>0){for(var b=0;b<c.length;b++){g.push(c[b]);}}}}return g;};a.Book.prototype=new a.Tree();a.Book.prototype.createRoot=function(b){this.data.update(b);
return this.data;};a.Book.prototype.each=function(d,e){e=e||this.data;d(e);if(e._children){for(var c=0;c<e._children().length;c++){var b=e._children()[c];if(b){this.each(d,b);}}}};a.Book.prototype.requiredCards=function(c){var b=[];model.carebook.each(function(d){if(d._card){b.push(d._card);}});return b;
};a.Book.prototype.find=function(c,g,e){e=e||"id";g=g||this.data;var b=undefined;var f=__get(e,g);if(f&&f===c){b=g;}else{if(g._children){for(var d=0;d<g._children().length;d++){b=this.find(c,g._children()[d],e);if(b){break;}}}}return b;};a.Book.prototype.findByKey=function(c,d){var e=this.data;var b=this.find(c,e,d);
return b;};a.Book.prototype.update=function(h){if(h.cardList){var f=this.findByKey(h.id,"id");var b=[];if(f!==undefined){for(var g=0;g<f._children().length;g++){var c=f._children()[g];var e=false;for(var d=0;d<h.entries.length;d++){var k=h.entries[d];if(c.id===k.id){e=true;}}if(!e){f._children.splice(g,1);
}}}this.load(h.entries,f);}else{var f=this.findByKey(h.card,"_card");if(f){f.update(h);}}};a.Book.prototype.load=function(n,b){function e(i,o){var p=new phil.books.Book(i);o.push(p);this.load(i["entries"],p);}function d(i,o){i.collapsible=this.collapsible;node=o.findByKey("id",i.id);if(!node){node=this.createCard.call(this,i,b,i.card);
o.push(node);}else{node.update(i);}this.load(i.properties,node);}function k(i,p){i.card=i.cardList;var o=p.findById(i.id);var q=p.findByKey("_card",i.card);if(q&&i.foreignKey){q=p.findByKey("foreignKey.value",i.foreignKey.value);}if(!q){i.collapsible=this.collapsible;q=this.createCard.call(this,i,b,"cardlist");
p.push(q);}this.load(i["entries"],q);}function h(i,o){var p=new a.Nodes(i,["object"]);o.push(p,false);this.load([i["object"]],p);}function c(i,p){var o=p.findByName(i.name);if(o.length===0){var q=new a.Nodes(i);p.push(q);}else{var q=o[0];phil.model.TypeMapper.update(i,q);}}function l(i,o){if(i.card){d.call(this,i,o);
}else{if(i.book){e.call(this,i,o);}else{if(i["object"].card){h.call(this,i,o);}else{c.call(this,i,o);}}}}function f(o,p){p.pause();if(o.cardList){k.call(this,o,p);}else{if(o["object"]&&o["object"].cardList){var i=o["object"];i.label=o.label;k.call(this,i,p);}else{l.call(this,o,p);}}p.resume();}if(!b){b=this.createRoot(n);
b.apply(n,["entries"]);n=n.entries;}for(var g=0;g<n.length;g++){var m=n[g];f.call(this,m,b);}};})(__ns("phil.model"));(function(a){a.TypeMapper=function(b){b=b||{};var c={};c.bookComponents={"DEFAULT":function(d,e){return c.resolveBookComponentDefault(d,e);},"ACTOR":function(d,e){return c.resolveWidgetSmartActor(d,e,false);
},"BOOLEAN":function(d,e){return c.resolveWidgetSmartBoolean(d,e,false);},"DATE":function(d,e){return c.resolveWidgetSmartDate(d,e,false);},"DATETIME":function(d,e){return c.resolveWidgetSmartDateTime(d,e,false);},"DOUBLE":function(d,e){return c.resolveWidgetSmartString(d,e,false);},"ENUMERATION":function(d,e){return c.resolveWidgetSmartString(d,e,false);
},"ID":function(d,e){return c.resolveWidgetSmartString(d,e,false);},"IMAGE":function(d,e){return c.resolveWidgetSmartImage(d,e);},"INTEGER":function(d,e){return c.resolveWidgetSmartString(d,e,false);},"LIST":function(d,e){return c.resolveWidgetSmartString(d,e,false);},"LIST_BOOLEAN":function(d,e){return c.resolveWidgetSmartString(d,e,false);
},"LIST_ENUM":function(d,e){return c.resolveWidgetSmartString(d,e,false);},"LIST_NUMBER":function(d,e){return c.resolveWidgetSmartString(d,e,false);},"LIST_STRING":function(d,e){return c.resolveWidgetSmartString(d,e,false);},"NUMBER":function(d,e){return c.resolveWidgetSmartString(d,e,false);},"PASSWORD":function(d,e){return c.resolveWidgetSmartString(d,e,true);
},"SELECT_ENUM":function(d,e){return c.resolveWidgetSmartString(d,e,false);},"STRING":function(d,e){return c.resolveWidgetSmartString(d,e,false);},"TAG":function(d,e){return c.resolveWidgetSmartString(d,e,false);},"TIME":function(d,e){return c.resolveWidgetSmartTime(d,e,false);}};c.resolve=function(e){var d=undefined;
if(e.name&&e["object"]){var f=e["object"].valueType;var g=c.bookComponents[f];if(!g){g=c.bookComponents["DEFAULT"];}d=g(e);}return d;};c.update=function(e,g){var d=undefined;if(e.name&&e["object"]){var f=e["object"].valueType;var h=c.bookComponents[f];if(!h){h=c.bookComponents["DEFAULT"];}d=h(e,g);}return d;
};c.resolveBookComponentDefault=function(d,e){if(!e){return phil.model.Paragraph({"name":d.name,"value":d["object"].value,"hidden":d.hidden});}else{e.updateSupported(d);}};c.resolveWidgetSmartActor=function(d,e){if(!e){return phil.model.SmartActor({"label":d.label,"name":d.name,"value":d["object"].value,"hidden":d.hidden});
}else{if(e.label){e.label.value(d.label);}e.value(d["object"].value);}};c.resolveWidgetSmartBoolean=function(d,e){if(!e){return phil.model.SmartBoolean({"label":d.label,"name":d.name,"value":d["object"].value,"hidden":d.hidden});}else{if(e.label){e.label.value(d.label);}e.value(d["object"].value);}};
c.resolveWidgetSmartString=function(f,h,d){var e=f["object"];var g=e.value;if(phil.isArray(e.value)){g=e.value.join(",");}if(!h){return phil.model.SmartString({"label":f.label,"name":f.name,"value":g,"mask":d,"hidden":f.hidden});}else{if(h._instance&&h._instance==="phil.model.SmartString"){if(h.label){h.label.value(f.label);
}h.value(g);}}};c.resolveWidgetSmartParagraph=function(f,h,d){var e=f["object"];var g=e.value;if(phil.isArray(e.value)){g=e.value.join(",");}if(!h){return phil.model.SmartParagraph({"label":f.label,"name":f.name,"value":g,"hidden":f.hidden});}else{if(h.label){h.label.value(f.label);}h.value(g);}};c.resolveWidgetSmartDate=function(e,f,d){if(!f){return phil.model.SmartDate({"label":e.label,"name":e.name,"value":e["object"].value,"hidden":e.hidden});
}else{if(f.label){f.label.value(e.label);}f.value(e["object"].value);}};c.resolveWidgetSmartDateTime=function(e,f,d){if(!f){return phil.model.SmartDateTime({"label":e.label,"name":e.name,"value":e["object"].value,"hidden":e.hidden});}else{if(f.label){f.label.value(e.label);}f.value(e["object"].value);
}};c.resolveWidgetSmartTime=function(e,f,d){if(!f){return phil.model.SmartTime({"label":e.label,"name":e.name,"value":e["object"].value,"hidden":e.hidden});}else{if(f.label){f.label.value(e.label);}f.value(e["object"].value);}};c.resolveWidgetSmartImage=function(d,e){if(!e){return phil.model.SmartImage({"label":d.label,"name":d.name,"value":d["object"].value,"hidden":d.hidden});
}else{if(e.label){e.label.value(d.label);}e.value(d["object"].value);}};return c;}();})(__ns("phil.model"));(function(a){a.Graph=function(c){c=c||{};var b=a.Element(c);b.data=phil.observe(c.data||[]);b.bands={"x":[40,70],"y":[40,70]};b.view=phil.observe("day");return b;};a.AbstractGraph=function(b){b=b||{};
__mixin(this,a.Element.call(this,b));this._dateFormat=b.dateFormat||"yyyy-MM-dd";this._margin=b.margin||{top:10,left:40,bottom:10,right:0};this._size={"width":320,"height":320};this._timeframe=b.timeframe||"day";this._xscale=undefined;this._yscale=undefined;this._cellParser=b.cellParser||this.cellParser;
this.data=phil.observe(b.data||[]);this.graph=undefined;Object.defineProperty(this,"margin",{get:function(){return this._margin;}});Object.defineProperty(this,"xscale",{set:function(c){this._xscale=c;},get:function(){return this._xscale;}});Object.defineProperty(this,"yscale",{set:function(c){this._yscale=c;
},get:function(){return this._yscale;}});};a.AbstractGraph.prototype=a.Element.prototype;a.AbstractGraph.prototype.cellParser=function(b){if(!b||b===""){return undefined;}return{val:+b,include:true};};a.AbstractGraph.prototype.clear=function(){this.data.splice(0,this.data().length);};a.AbstractGraph.prototype.clearAxis=function(){if(this.graph){this.graph.selectAll(".axis").remove();
}};a.AbstractGraph.prototype.clearPoints=function(){if(this.graph){this.graph.selectAll("g").remove();}};a.AbstractGraph.prototype.createGraph=function(c){var b=this.size(c);this.svg=d3.select(c).append("svg").attr("class","graph").attr("width",b.width).attr("height",b.height);this.graph=this.svg.append("g").attr("transform","translate("+this.margin.left+","+this.margin.top+")");
};a.AbstractGraph.prototype.updateGraph=function(){if(this.svg){this.svg.attr("width",this._size.width).attr("height",this._size.height);}};a.AbstractGraph.prototype.plot=function(b){var c=this.graph.selectAll("g").data(this.processRanges(b));return c;};a.AbstractGraph.prototype.processRanges=function(b){return b;
};a.AbstractGraph.prototype.plotAxis=function(){this.plotXAxis();this.plotYAxis();};a.AbstractGraph.prototype.plotXAxis=function(){};a.AbstractGraph.prototype.plotYAxis=function(){};a.AbstractGraph.prototype.parse=function(b){this.data(b);return this.parseCSV();};a.AbstractGraph.prototype.parseCSV=function(m){m=m||the.parseDateTime;
var l={ranges:[],limits:{xMin:Number.MAX_SAFE_INTEGER,xMax:Number.MIN_SAFE_INTEGER,yMin:Number.MAX_SAFE_INTEGER,yMax:Number.MIN_SAFE_INTEGER}};var d=this.data();if(!d||d.length===0){return l;}l.ranges=this.parseCSVHeaders(d[0]);var c=l.ranges;var b=l.limits;for(var h=1;h<d.length;h++){var o=d[h];var f=o[0];
var n=m(f,this._dateFormat);if(h===1){b.xMin=n;}if(h===d.length-1){b.xMax=n;}for(var e=1;e<o.length;e++){c[e].col=e;var k=this._cellParser(o[e],h,e,d[0][e]);if(k&&k!==""){var g=k.val;if(k.include&&!isNaN(g)){if(g<b.yMin){b.yMin=g;}if(g>b.yMax){b.yMax=g;}if(g<c[e].min){c[e].min=g;}if(g>c[e].max){c[e].max=g;
}}c[e].values.push({date:n,val:g,original:k.original||g,col:e-1});}}}c.splice(0,1);return l;};a.AbstractGraph.prototype.parseCSVHeaders=function(d){var c=[];for(var b=0;b<d.length;b++){c.push({name:d[b],values:[],min:Number.MAX_SAFE_INTEGER,max:Number.MIN_SAFE_INTEGER});}return c;};a.AbstractGraph.prototype.size=function(d){var b=d.offsetHeight||320;
var c=d.offsetWidth||320;this._size={"width":c,"height":b};return this._size;};})(__ns("phil.model"));(function(a){a.LineGraph=function(b){b=b||{};a.AbstractGraph.call(this,b);this.interpolate=b.interpolate||"linear";this.normalise=phil.observe(b.normalise||false);this.showLabels=b.showLabels===undefined?true:b.showLabels;
this.showXRanges=b.showXRanges===undefined?true:b.showXRanges;this.showYRanges=b.showYRanges===undefined?true:b.showYRanges;this.ticks=b.ticks===undefined?5:b.ticks;this.tickFormat=b.tickFormat===undefined?d3.time.format("%a %d"):d3.time.format(b.tickFormat);this._line=d3.svg.line().interpolate("linear").x(function(c){return this.xscale(c.date);
}.bind(this)).y(function(c){return this.yscale[0](c.val);}.bind(this));Object.defineProperty(this,"line",{get:this.getSetLine.bind(this),set:this.getSetLine.bind(this)});};a.LineGraph.prototype=Object.create(a.AbstractGraph.prototype);a.LineGraph.prototype.calcXScales=function(b){this.xscale=d3.time.scale().domain([b.limits.xMin,d3.time.day.offset(b.limits.xMax,0)]).rangeRound([0,this._size.width-this._margin.left-this._margin.right]);
};a.LineGraph.prototype.calcYScales=function(b){this.yscale={};this.yscale[0]=d3.scale.linear().domain([b.limits.yMin,b.limits.yMax]).range([(this._size.height-this._margin.top-this._margin.bottom-this._margin.bottom),0]);};a.LineGraph.prototype.plot=function(b){var c=a.AbstractGraph.prototype.plot.call(this,b);
c.enter().append("g");c.append("path").attr("class",function(d){if(!d.name){return"";}return"line "+"line"+d.col;}).attr("d",function(e){return this.line(e.values);}.bind(this));if(this.showLabels){this.plotLabels(c);}return c;};a.LineGraph.prototype.plotXAxis=function(){var d=this.tickFormat;var b=this.ticks;
var c=d3.svg.axis().scale(this._xscale).orient("bottom").ticks(b).tickFormat(d).tickSize(1,1).tickPadding(8);if(this.showXRanges){this.graph.append("g").attr("class","x axis").attr("transform","translate(0, "+(this._size.height-this._margin.top-this._margin.bottom-this._margin.top)+")").call(c);}};a.LineGraph.prototype.plotYAxis=function(){var b=d3.svg.axis().scale(this._yscale[0]).orient("left").tickFormat(function(c){return c+"";
}).tickSize(1,1).ticks(4);if(this.showYRanges){this.graph.append("g").attr("class","y axis").attr("transform","translate(0, 0)").call(b).append("text");}};a.LineGraph.prototype.plotLabels=function(e){var c=this.xscale;var b=this.yscale[0];var d=this._limits;e.append("text").datum(function(f){return{name:f.name,value:f.values[f.values.length-1]};
}).attr("transform",function(f){if(!f.value){return"translate("+c(d.xMax)+","+(b(d.yMin)-20)+" )";}return"translate("+c(f.value.date)+","+b(f.value.val)+")";}).attr("x",3).attr("dy",".35em").text(function(f){return f.name;});};a.LineGraph.prototype.getSetLine=function(b){if(b){this._line=b;}return this._line;
};a.LineGraph.prototype.parseCSV=function(){var b=a.AbstractGraph.prototype.parseCSV.call(this);this.calcXScales(b);this.calcYScales(b);return b;};})(__ns("phil.model"));(function(a){a.GraphScatter=function(b){b=b||{};a.AbstractGraph.call(this,b);this.interpolate=b.interpolate||"linear";this.normalise=phil.observe(b.normalise||false);
this.showLabels=b.showLabels||true;this._pointRadius=function(c){return 10;};Object.defineProperty(this,"pointRadius",{get:function(){return this._pointRadius;}.bind(this),set:function(c){this._pointRadius=c;}.bind(this)});};a.GraphScatter.prototype=Object.create(a.AbstractGraph.prototype);a.GraphScatter.prototype.calcXScales=function(b){this.xscale=d3.time.scale().domain([b.limits.xMin,d3.time.day.offset(b.limits.xMax,1)]).rangeRound([0,this._size.width-this._margin.left-this._margin.right]);
};a.GraphScatter.prototype.calcYScales=function(b){this.yscale={};this.yscale[0]=d3.scale.linear().domain([b.limits.yMin,b.limits.yMax]).range([(this._size.height-this._margin.top-this._margin.bottom-this._margin.bottom),0]);};a.GraphScatter.prototype.plot=function(d){var e=a.AbstractGraph.prototype.plot.call(this,d);
var c=this.xscale;var b=this.yscale;var f=this._pointRadius;var g=e.enter().append("g").attr("class",function(h,i){return"range range_"+h.col+" range_"+h.name;});var e=g.selectAll(".point").data(function(h){return h.values;}).enter().append("circle").attr("class","point").attr("cy",function(h){return b[0](h.val);
}).attr("cx",function(h){return c(h.date);}).attr("r",f);return e;};a.GraphScatter.prototype.plotXAxis=function(){var d=d3.time.format("%a %d");var b=5;var c=d3.svg.axis().scale(this._xscale).orient("bottom").ticks(b).tickFormat(d).tickSize(1,1).tickPadding(8);this.graph.append("g").attr("class","x axis").attr("transform","translate(0, "+(this._size.height-this._margin.top-this._margin.bottom-this._margin.top)+")").call(c);
};a.GraphScatter.prototype.plotYAxis=function(){var b=d3.svg.axis().scale(this._yscale[0]).orient("left").tickFormat(function(c){return c+"";}).tickSize(1,1).ticks(4);this.graph.append("g").attr("class","y axis").attr("transform","translate(0, 0)").call(b).append("text");};a.GraphScatter.prototype.plotLabels=function(e){var c=this.xscale;
var b=this.yscale[0];var d=this._limits;e.append("text").datum(function(f){return{name:f.name,value:f.values[f.values.length-1]};}).attr("transform",function(f){if(!f.value){return"translate("+c(d.xMax)+","+(b(d.yMin)-20)+" )";}return"translate("+c(f.value.date)+","+b(f.value.val)+")";}).attr("x",3).attr("dy",".35em").text(function(f){return f.name;
});};a.GraphScatter.prototype.getSetLine=function(b){if(b){this._line=b;}return this._line;};a.GraphScatter.prototype.parseCSV=function(){var b=a.AbstractGraph.prototype.parseCSV.call(this);this.calcXScales(b);this.calcYScales(b);return b;};})(__ns("phil.model"));(function(a){a.Filterable=function(b){b=b||{};
var c={};c._filter=b;c.filtered=function(){return ko.computed(function(){var f=[];var d=this();for(var e=0;e<d.length;e++){if(c._filter.key&&c._filter.val){if(d[e][c._filter.key]===c._filter.val){f.push(d[e]);}}else{f.push(d[e]);}}return f;},this);};c.filter=function(d){if(!d){return c._filter;}else{c._filter=d;
this.valueHasMutated();}};return c;};})(__ns("phil.collections"));(function(a){a.Uniqable=function(b){b=b||{};var c={};c._uniqable=b;c._uniqable._keys={};c._add=function(f,e){var d=true;if(c._uniqable.exists){d=c._uniqable.exists(c._uniqable._keys,f);}else{if(c._uniqable.key){var g=c._uniqable.key?f[c._uniqable.key]:f;
if(g&&!this._uniqable._keys[g]){d=false;}else{}}else{new Exception("phil.collections.list.Uniqable: No Unique 'key' specified.");}}if(d===false){var g=c._uniqable.key?f[c._uniqable.key]:f;this._uniqable._keys[g]=true;this._addItem(f,e);}};c.clear=function(){this._uniqable._keys={};this.splice(0,this().length);
};c._del=function(d,e){var e=this()[d];var f=c._uniqable.key?e[c._uniqable.key]:e;delete this._uniqable._keys[f];this.splice(d,1);};return c;};})(__ns("phil.collections"));(function(a){a.Queryable=function(b){b=b||{};var c={};c._queryable=b;c.all=function(k,h){var f=this();if(this._queryable.all){return this._queryable.all(f);
}var e=[];for(var d=0;d<f.length;d++){var g=h?f[d][h]:f[d];if(phil.isFunc(g)){g=g();}if(g===k){e.push(f[d]);}}return e;};c.one=function(k,h){var f=this();if(this._queryable.single){return this._queryable.single(f);}var d=undefined;for(var e=0;e<f.length;e++){var g=h?f[e][h]:f[e];if(phil.isFunc(g)){g=g();
}if(g===k){d=f[e];}}return d;};return c;};})(__ns("phil.collections"));(function(a){a.Selectable=function(b){b=b||{};var c={};c._singleSelect=b.single!==undefined?b.single:false;c.unselectAll=function(){var d=this();for(var e=0;e<d.length;e++){if(d[e].selected){d[e].selected(false);}}};return c;};})(__ns("phil.collections"));
(function(a){a.Sortable=function(b){b=b||{};var c={};c._sortable=b;c.sorted=function(){return ko.computed(function(){var e=this();var d=[];if(!c._sortable.sorter){d=the.quickSort(e,c._sortable.key);}else{d=c._sortable.sorter(e);}return d;},this);};c.sortableOptions=function(d){if(!d){return c._sortable;
}else{c._sortable=d;this.valueHasMutated();}};return c;};})(__ns("phil.collections"));(function(a){a.List=function(f,c){c=c||{};c.mixins=c.mixins||{};f=f||[];var b=ko.observableArray(f).extend({rateLimit:50});var e={"_addItem":function(h,g){this._observe(h);if(g&&g===true){this.unshift(h);}else{this.push(h);
}},"_add":function(h,g){this._addItem(h,g);},"add":function(g){if(phil.isArray(g)){for(var h=0;h<g.length;h++){this._add(g[h]);}}else{this._add(g);}return this;},"prepend":function(g){if(phil.isArray(g)){for(var h=0;h<g.length;h++){this._add(g[h],true);}}else{this._add(g,true);}return this;},"clear":function(){this.splice(0,this().length);
return this;},"_preDel":[],"_del":function(g){this.splice(g,1);},"del":function(n,h){var k=this();for(var g=k.length-1;g>=0;g--){var l=k[g];var m=h?l[h]:l;if(m&&m===n){this._del(g);}}return this;},"each":function(l){var h=this();for(var k=0;k<h.length;k++){var g=l(h[k],k,h);if(g==="break"){break;}}},"get":function(o,k){var g=undefined;
var l=this();for(var h=l.length-1;h>=0;h--){var m=l[h];var n=k?m[k]:m;if(n&&n===o){g=m;break;}}return g;},"_observe":function(g){if(!g||!g.listen){return -1;}g.listen("*",function(){this.trigger.apply(this,arguments);}.bind(this));},"_updateItem":function(g){}};ko.utils.extend(b,e);ko.utils.extend(b,phil.mixins.Observable());
for(var d in c.mixins){ko.utils.extend(b,phil.collections[d].call(b,c.mixins[d]));}return b;};})(__ns("phil.collections"));(function(a){a.Reflection=function(d,e){var c=ko.computed(function(f){var h=[];var f=d.sorted?d.sorted()():d();for(var g=0;g<f.length;g++){var k=e?e(f[g]):f[g];if(!k||k.listen){k.listen("*",function(){c.trigger.apply(this,arguments);
}.bind(this));}h.push(k);}return h;});var b={"paused":phil.observe(false),"pause":function(){this.paused(true);},"free":function(){this.paused(false);},"get":function(n,h){var f=undefined;var k=this();for(var g=k.length-1;g>=0;g--){var l=k[g];var m=h?l[h]:l;if(m&&m===n){f=l;break;}}return f;}};ko.utils.extend(c,phil.mixins.Observable());
ko.utils.extend(c,b);return c;};})(__ns("phil.collections"));(function(a){a.CSVTable=function(e){var c=["ok","notify","warning","error","system","image","backgroundColor","heading"];e=[];var b=a.List(e);var d={"parseCell":function(g){var f={style:"",value:"",inline:""};f.value=g?g.toString():"";var i=f.value.indexOf("#");
if(i>=0){var h=f.value.split("#");if(c.indexOf(h[0])>-1){f.style=h[0];f.value=h[1];}}if(f.value.indexOf("data:image")>-1){f.value='<img src="'+f.value+'"></img>';}return f;},"insertRow":function(g){var h=ko.observableArray([]);for(var f=0;f<g.length;f++){h.push(this.parseCell(g[f]));}this.push(h);}};
ko.utils.extend(b,d);return b;};})(__ns("phil.collections"));(function(a){a.AbstractCard=function(e,b,c){var f=a.AbstractCard.PERF("AbstractCard constructor");__mixin(this,phil.mixins.Observable());for(var d in b){__mixin(this,phil.mixins[d]());}this._unwrap=c.unwrap!==undefined?c.unwrap:true;this._data=e;
this._tmpl="card-abstract";Object.defineProperty(this,"tmpl",{get:function(){return this._tmpl;},set:function(g){this._tmpl=g;}});Object.defineProperty(this,"data",{get:this.jsonify.bind(this),set:this.parse.bind(this)});f.stop();};a.AbstractCard.PERF=window.perf||function(){return{stop:function(){}};
};a.AbstractCard.prototype={};a.AbstractCard.prototype.init=function(){this.parse.call(this);return this;};a.AbstractCard.prototype.refresh=function(){return this;};a.AbstractCard.prototype.parse=function(b){var c=a.AbstractCard.PERF("AbstractCard parse");if(this.verify(b)){this._data=b;}c.stop();};a.AbstractCard.prototype.verify=function(b){var c=a.AbstractCard.PERF("AbstractCard verify");
c.stop();return true;};a.AbstractCard.prototype.jsonify=function(){var b=a.AbstractCard.PERF("AbstractCard jsonify");b.stop();if(this._unwrap===true){return this._data;}else{return this;}};})(__ns("phil.collections"));(function(a){var b=a.AbstractCard;a.CollapsibleCard=function(d,c){var e=a.AbstractCard.PERF("CollapsibleCard constructor");
b.call(this,d,c);this._tmpl="card-collapsible";this._state=a.AbstractCard.PARTIAL;Object.defineProperty(this,"state",{get:function(){return this._state;},set:function(f){this._state=f;this.parse();}});e.stop();};a.CollapsibleCard.PARTIAL=0;a.CollapsibleCard.FULL=1;a.CollapsibleCard.prototype=Object.create(b.prototype);
a.CollapsibleCard.prototype.parse=function(c){b.prototype.parse.call(this,c);if(this.state===a.CollapsibleCard.FULL){this.parseFull.call(this,c);}};a.CollapsibleCard.prototype.parseFull=function(c){};})(__ns("phil.collections"));(function(a){var b=a.AbstractCard;a.SingleLineItem=function(d,c){c=c||{};
b.call(this,d,{"Selectable":true});this._unwrap=c.unwrap!==undefined?c.unwrap:true;this._tmpl="single-line-item";this.label=phil.observe();this.description=phil.observe();this.primary=function(f,e){this._trigger.call(this,f,e,"primary");}.bind(this);if(c.secondary!==undefined){this.secondary=function(f,e){this._trigger.call(this,f,e,"secondary");
}.bind(this);}this.css=phil.compute(function(){var e=[];if(this._selected()){e.push("selected");}if(this.secondary){e.push("sli-dis");}else{e.push("sli-bas");}return e.join(" ");}.bind(this));};a.SingleLineItem.prototype=Object.create(b.prototype);a.SingleLineItem.prototype._trigger=function(e,c,d){c.preventDefault();
c.stopPropagation();this.trigger(d,e,c);};a.SingleLineItem.prototype.verify=function(d){b.prototype.verify.call(this,d);var c=false;if(d){if(d.label){c=true;}}return c;};a.SingleLineItem.prototype.parse=function(c){b.prototype.parse.call(this,c);this.label(this._data.label);};a.SingleLineItem.prototype.jsonify=function(){if(this._unwrap===true){this._data.label=this.label();
return b.prototype.jsonify.call(this);}else{return this;}};})(__ns("phil.collections"));(function(){!function(c){var b=function(e,d){this.$element=c(e);this.options=c.extend({},c.fn.button.defaults,d);this._value=this.options.value||undefined;this._pressed=false;};b.prototype.setState=function(g){var i="disabled",e=this.$element,f=e.data(),h=e.is("input")?"val":"html";
g=g+"Text";f.resetText||e.data("resetText",e[h]());e[h](f[g]||this.options[g]);setTimeout(function(){g=="loadingText"?e.addClass(i).attr(i,i):e.removeClass(i).removeAttr(i);},0);};b.prototype.toggle=function(){var e=this.$element.closest('[data-toggle="buttons-radio"]');e&&e.find(".active").removeClass("active");
var d=undefined;if(phil.isFunc(this._value)){d=this._value();}if((d===undefined)||(d===true)){this.$element.toggleClass("active");}else{this.$element.removeClass("active");}};b.prototype.updateValue=function(){if(phil.isFunc(this._value)){this._value(!this._value());}};var a=c.fn.button;c.fn.button=function(d){return this.each(function(){var g=c(this),f=g.data("button"),e=typeof d=="object"&&d;
if(!f){g.data("button",(f=new b(this,e)));}if(d){if(d=="toggle"){f.toggle();}}else{if(d){f.setState(d);}}});};c.fn.button.defaults={loadingText:"loading..."};c.fn.button.Constructor=b;c.fn.button.noConflict=function(){c.fn.button=a;return this;};c(document).on("click.button.data-api","[data-toggle^=button]",function(f){var d=c(f.target);
if(!d.hasClass("btn")){d=d.closest(".btn");}d.button("toggle");});}(window.jQuery);})();(function(){!function($){var CardHost=function(element,options){var me=this;this.$element=$(element);this.addCapability=options.addCapability||function(){};this.pulse=options.pulse||function(){};options.pulsed=this.pulsed;
this.locale=options.locale||this.locale;this.knockout=true;this.pulsing=true;this.profiles=options.profiles||[];this.cards=options.cards||[];if(!this.cards.addCard){this.knockout=false;this.cards.addCard=function(card){var type=card.type.replace(/\./g,"_");if(phil.cards[type]){__mixin(card,phil.cards[type]);
}this.push(card);return card;};}};CardHost.prototype.postinit=function(){var me=this;if(me.pulsing){me.addCapability("PRODUCER","pumpCo.user.card.list.request");me.addCapability("CONSUMER","pumpCo.user.card.list.response",function(exchange){me.pulsed(exchange.getPulseClass(),exchange.getPulseBody(),"refid");
});var profilesCollection=[];for(var i=0;i<this.profiles.length;i++){profilesCollection.push({"name":this.profiles[i]});}var body={"card":profilesCollection};me.pulse.call(this,"pumpCo.user.card.list.request",body);}};CardHost.prototype.fix=function(value){for(var key in value){if(typeof value[key]==="object"){value[key]=this.fix(value[key]);
}if(key.indexOf("-")){var newKey=key.replace(/-/g,"");value[newKey]=value[key];}}return value;};CardHost.prototype.pulsed=function(namespace,body,refid){var cards=body.card;var templates=cards.template||[];for(var i=0;i<templates.length;i++){var template=templates[i];template.type=template.name;this.addCard(template);
}var data=cards.data||[];for(var i=0;i<data.length;i++){var cardData=data[i];cardData=this.fix(cardData);cardData.type=cardData.name;this.drawCard(cardData);}if(this.knockout===false){this.redraw();}};CardHost.prototype.addCard=function(card){var type=card.type.replace(/\./g,"_");if(!phil.cards[type]){eval(card.script);
if(this.knockout){var lang=this.getNestedI18n(card.lang);var html=phil.tmpl(type,lang||{});this.addTemplate(type,html);}}};CardHost.prototype.getNestedI18n=function(lang,parent){var language=parent||this.locale();if(lang[language]){return lang[language];}var parent=language.substring(0,language.lastIndexOf("-"));
return parent===""?lang["en"]:this.getNestedI18n(lang,parent);};CardHost.prototype.addTemplate=function(name,html){var elem=$("#"+name);if(elem.length>=1){return;}var tag='<script id="'+name+'" type="text/html">'+html+"<\/script>";$("body").append(tag);};CardHost.prototype.drawCard=function(card){var type=card.type.replace(/\./g,"_");
if(phil.cards[type]){this.cards.addCard(card);}};CardHost.prototype.redraw=function(){this.$element.html("");var cards=phil.isFunc(this.cards)?this.cards():this.cards;for(var i=0;i<cards.length;i++){var type=cards[i].type.replace(/\./g,"_");var html=phil.tmpl(type,cards[i].value);var html=html.replace(/data-bind/g,"data-replaced");
this.$element.append(html);}};$.fn.cardhost=function(option){return this.each(function(){var $this=$(this),data=$this.data("instance"),options=typeof option=="object"&&option;if(!data){$this.data("instance",(data=new CardHost(this,options)));}});};$.fn.button.Constructor=CardHost;}(window.jQuery);})();
/*!
 * Timepicker Component for Twitter Bootstrap
 *
 * Copyright 2013 Joris de Wit
 *
 * Contributors https://github.com/jdewit/bootstrap-timepicker/graphs/contributors
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 */
(function(d,c,a,e){var b=function(g,f){this.widget="";
this._element=g;this.$element=d(g);this.defaultTime=f.defaultTime;this.disableFocus=f.disableFocus;this.disableMousewheel=f.disableMousewheel;this.isOpen=f.isOpen;this.minuteStep=f.minuteStep;this.modalBackdrop=f.modalBackdrop;this.orientation=f.orientation;this.secondStep=f.secondStep;this.showInputs=f.showInputs;
this.showMeridian=f.showMeridian;this.showSeconds=f.showSeconds;this.template=f.template;this.appendWidgetTo=f.appendWidgetTo;this.showWidgetOnAddonClick=f.showWidgetOnAddonClick;this._init();};b.prototype={constructor:b,_init:function(){var f=this;if(this.showWidgetOnAddonClick&&(this.$element.parent().hasClass("input-append")||this.$element.parent().hasClass("input-prepend"))){this.$element.parent(".input-append, .input-prepend").find(".add-on").on({"click.timepicker":d.proxy(this.showWidget,this)});
this.$element.on({"focus.timepicker":d.proxy(this.highlightUnit,this),"click.timepicker":d.proxy(this.highlightUnit,this),"keydown.timepicker":d.proxy(this.elementKeydown,this),"blur.timepicker":d.proxy(this.blurElement,this),"mousewheel.timepicker DOMMouseScroll.timepicker":d.proxy(this.mousewheel,this)});
}else{if(this.template){this.$element.on({"focus.timepicker":d.proxy(this.showWidget,this),"click.timepicker":d.proxy(this.showWidget,this),"blur.timepicker":d.proxy(this.blurElement,this),"mousewheel.timepicker DOMMouseScroll.timepicker":d.proxy(this.mousewheel,this)});}else{this.$element.on({"focus.timepicker":d.proxy(this.highlightUnit,this),"click.timepicker":d.proxy(this.highlightUnit,this),"keydown.timepicker":d.proxy(this.elementKeydown,this),"blur.timepicker":d.proxy(this.blurElement,this),"mousewheel.timepicker DOMMouseScroll.timepicker":d.proxy(this.mousewheel,this)});
}}if(this.template!==false){this.$widget=d(this.getTemplate()).on("click",d.proxy(this.widgetClick,this));}else{this.$widget=false;}if(this.showInputs&&this.$widget!==false){this.$widget.find("input").each(function(){d(this).on({"click.timepicker":function(){d(this).select();},"keydown.timepicker":d.proxy(f.widgetKeydown,f),"keyup.timepicker":d.proxy(f.widgetKeyup,f)});
});}this.setDefaultTime(this.defaultTime);},blurElement:function(){this.highlightedUnit=null;this.updateFromElementVal();},clear:function(){this.hour="";this.minute="";this.second="";this.meridian="";this.$element.val("");},decrementHour:function(){if(this.showMeridian){if(this.hour===1){this.hour=12;
}else{if(this.hour===12){this.hour--;return this.toggleMeridian();}else{if(this.hour===0){this.hour=11;return this.toggleMeridian();}else{this.hour--;}}}}else{if(this.hour<=0){this.hour=23;}else{this.hour--;}}},decrementMinute:function(g){var f;if(g){f=this.minute-g;}else{f=this.minute-this.minuteStep;
}if(f<0){this.decrementHour();this.minute=f+60;}else{this.minute=f;}},decrementSecond:function(){var f=this.second-this.secondStep;if(f<0){this.decrementMinute(true);this.second=f+60;}else{this.second=f;}},elementKeydown:function(f){switch(f.keyCode){case 9:case 27:this.updateFromElementVal();break;case 37:f.preventDefault();
this.highlightPrevUnit();break;case 38:f.preventDefault();switch(this.highlightedUnit){case"hour":this.incrementHour();this.highlightHour();break;case"minute":this.incrementMinute();this.highlightMinute();break;case"second":this.incrementSecond();this.highlightSecond();break;case"meridian":this.toggleMeridian();
this.highlightMeridian();break;}this.update();break;case 39:f.preventDefault();this.highlightNextUnit();break;case 40:f.preventDefault();switch(this.highlightedUnit){case"hour":this.decrementHour();this.highlightHour();break;case"minute":this.decrementMinute();this.highlightMinute();break;case"second":this.decrementSecond();
this.highlightSecond();break;case"meridian":this.toggleMeridian();this.highlightMeridian();break;}this.update();break;}},getCursorPosition:function(){var g=this.$element.get(0);if("selectionStart" in g){return g.selectionStart;}else{if(a.selection){g.focus();var h=a.selection.createRange(),f=a.selection.createRange().text.length;
h.moveStart("character",-g.value.length);return h.text.length-f;}}},getTemplate:function(){var h,k,g,f,i,l;if(this.showInputs){k='<input type="text" class="timepicker-hour" maxlength="2"/>';g='<input type="text" class="timepicker-minute" maxlength="2"/>';f='<input type="text" class="timepicker-second" maxlength="2"/>';
i='<input type="text" class="timepicker-meridian" maxlength="2"/>';}else{k='<span class="timepicker-hour"></span>';g='<span class="timepicker-minute"></span>';f='<span class="timepicker-second"></span>';i='<span class="timepicker-meridian"></span>';}l="<table>"+"<tr>"+'<td><a href="#" data-action="incrementHour"><i class="ico ico-caret"></i></a></td>'+'<td class="separator">&nbsp;</td>'+'<td><a href="#" data-action="incrementMinute"><i class="ico ico-caret"></i></a></td>'+(this.showSeconds?'<td class="separator">&nbsp;</td>'+'<td><a href="#" data-action="incrementSecond"><i class="ico ico-caret"></i></a></td>':"")+(this.showMeridian?'<td class="separator">&nbsp;</td>'+'<td class="meridian-column"><a href="#" data-action="toggleMeridian"><i class="ico ico-caret"></i></a></td>':"")+"</tr>"+"<tr>"+"<td>"+k+"</td> "+'<td class="separator">:</td>'+"<td>"+g+"</td> "+(this.showSeconds?'<td class="separator">:</td>'+"<td>"+f+"</td>":"")+(this.showMeridian?'<td class="separator">&nbsp;</td>'+"<td>"+i+"</td>":"")+"</tr>"+"<tr>"+'<td><a href="#" data-action="decrementHour"><i class="ico ico-caron"></i></a></td>'+'<td class="separator"></td>'+'<td><a href="#" data-action="decrementMinute"><i class="ico ico-caron"></i></a></td>'+(this.showSeconds?'<td class="separator">&nbsp;</td>'+'<td><a href="#" data-action="decrementSecond"><i class="ico ico-caron"></i></a></td>':"")+(this.showMeridian?'<td class="separator">&nbsp;</td>'+'<td><a href="#" data-action="toggleMeridian"><i class="ico ico-caron"></i></a></td>':"")+"</tr>"+"</table>";
switch(this.template){case"modal":h='<div class="timepicker modal hide fade in" data-backdrop="'+(this.modalBackdrop?"true":"false")+'">'+'<div class="modal-header">'+'<a href="#" class="close" data-dismiss="modal">×</a>'+"<h3>Pick a Time</h3>"+"</div>"+'<div class="modal-content">'+l+"</div>"+'<div class="modal-footer">'+'<a href="#" class="btn btn-primary" data-dismiss="modal">OK</a>'+"</div>"+"</div>";
break;case"dropdown":h='<div class="timepicker dropdown-menu">'+l+"</div>";break;}return h;},getTime:function(){if(this.hour===""){return"";}var f=this.hour.toString();if(!this.showMeridian){f=f.length===1?"0"+f:f;}return f+":"+(this.minute.toString().length===1?"0"+this.minute:this.minute)+(this.showSeconds?":"+(this.second.toString().length===1?"0"+this.second:this.second):"")+(this.showMeridian?" "+this.meridian:"");
},hideWidget:function(){if(this.isOpen===false){return;}this.$element.trigger({"type":"hide.timepicker","time":{"value":this.getTime(),"hours":this.hour,"minutes":this.minute,"seconds":this.second,"meridian":this.meridian}});if(this.template==="modal"&&this.$widget.modal){this.$widget.modal("hide");}else{this.$widget.removeClass("displayed");
}d(a).off("mousedown.timepicker, touchend.timepicker");this.isOpen=false;this.$widget.detach();},highlightUnit:function(){this.position=this.getCursorPosition();if(this.position>=0&&this.position<=2){this.highlightHour();}else{if(this.position>=3&&this.position<=5){this.highlightMinute();}else{if(this.position>=6&&this.position<=8){if(this.showSeconds){this.highlightSecond();
}else{this.highlightMeridian();}}else{if(this.position>=9&&this.position<=11){this.highlightMeridian();}}}}},highlightNextUnit:function(){switch(this.highlightedUnit){case"hour":this.highlightMinute();break;case"minute":if(this.showSeconds){this.highlightSecond();}else{if(this.showMeridian){this.highlightMeridian();
}else{this.highlightHour();}}break;case"second":if(this.showMeridian){this.highlightMeridian();}else{this.highlightHour();}break;case"meridian":this.highlightHour();break;}},highlightPrevUnit:function(){switch(this.highlightedUnit){case"hour":if(this.showMeridian){this.highlightMeridian();}else{if(this.showSeconds){this.highlightSecond();
}else{this.highlightMinute();}}break;case"minute":this.highlightHour();break;case"second":this.highlightMinute();break;case"meridian":if(this.showSeconds){this.highlightSecond();}else{this.highlightMinute();}break;}},highlightHour:function(){var f=this.$element.get(0),g=this;this.highlightedUnit="hour";
if(f.setSelectionRange){setTimeout(function(){if(g.hour<10){f.setSelectionRange(0,1);}else{f.setSelectionRange(0,2);}},0);}},highlightMinute:function(){var f=this.$element.get(0),g=this;this.highlightedUnit="minute";if(f.setSelectionRange){setTimeout(function(){if(g.hour<10){f.setSelectionRange(2,4);
}else{f.setSelectionRange(3,5);}},0);}},highlightSecond:function(){var f=this.$element.get(0),g=this;this.highlightedUnit="second";if(f.setSelectionRange){setTimeout(function(){if(g.hour<10){f.setSelectionRange(5,7);}else{f.setSelectionRange(6,8);}},0);}},highlightMeridian:function(){var f=this.$element.get(0),g=this;
this.highlightedUnit="meridian";if(f.setSelectionRange){if(this.showSeconds){setTimeout(function(){if(g.hour<10){f.setSelectionRange(8,10);}else{f.setSelectionRange(9,11);}},0);}else{setTimeout(function(){if(g.hour<10){f.setSelectionRange(5,7);}else{f.setSelectionRange(6,8);}},0);}}},incrementHour:function(){if(this.showMeridian){if(this.hour===11){this.hour++;
return this.toggleMeridian();}else{if(this.hour===12){this.hour=0;}}}if(this.hour===23){this.hour=0;return;}this.hour++;},incrementMinute:function(g){var f;if(g){f=this.minute+g;}else{f=this.minute+this.minuteStep-(this.minute%this.minuteStep);}if(f>59){this.incrementHour();this.minute=f-60;}else{this.minute=f;
}},incrementSecond:function(){var f=this.second+this.secondStep-(this.second%this.secondStep);if(f>59){this.incrementMinute(true);this.second=f-60;}else{this.second=f;}},mousewheel:function(g){if(this.disableMousewheel){return;}g.preventDefault();g.stopPropagation();var h=g.originalEvent.wheelDelta||-g.originalEvent.detail,f=null;
if(g.type==="mousewheel"){f=(g.originalEvent.wheelDelta*-1);}else{if(g.type==="DOMMouseScroll"){f=40*g.originalEvent.detail;}}if(f){g.preventDefault();d(this).scrollTop(f+d(this).scrollTop());}switch(this.highlightedUnit){case"minute":if(h>0){this.incrementMinute();}else{this.decrementMinute();}this.highlightMinute();
break;case"second":if(h>0){this.incrementSecond();}else{this.decrementSecond();}this.highlightSecond();break;case"meridian":this.toggleMeridian();this.highlightMeridian();break;default:if(h>0){this.incrementHour();}else{this.decrementHour();}this.highlightHour();break;}return false;},place:function(){if(this.isInline){return;
}var h=this.$widget.outerWidth(),p=this.$widget.outerHeight(),k=10,m=d(c).width(),g=d(c).height(),l=d(c).scrollTop();var s=parseInt(this.$element.parents().filter(function(){}).first().css("z-index"),10)+10;var o=this.component?this.component.parent().offset():this.$element.offset();var t=this.component?this.component.outerHeight(true):this.$element.outerHeight(false);
var i=this.component?this.component.outerWidth(true):this.$element.outerWidth(false);var n=o.left,r=o.top;this.$widget.removeClass("timepicker-orient-top timepicker-orient-bottom timepicker-orient-right timepicker-orient-left");if(this.orientation.x!=="auto"){this.picker.addClass("datepicker-orient-"+this.orientation.x);
if(this.orientation.x==="right"){n-=h-i;}}else{this.$widget.addClass("timepicker-orient-left");if(o.left<0){n-=o.left-k;}else{if(o.left+h>m){n=m-h-k;}}}var f=this.orientation.y,q,u;if(f==="auto"){q=-l+o.top-p;u=l+g-(o.top+t+p);if(Math.max(q,u)===u){f="top";}else{f="bottom";}}this.$widget.addClass("timepicker-orient-"+f);
if(f==="top"){r+=t;}else{r-=p+parseInt(this.$widget.css("padding-top"),10);}this.$widget.css({top:r,left:n,zIndex:s});},remove:function(){d("document").off(".timepicker");if(this.$widget){this.$widget.remove();}delete this.$element.data().timepicker;},setDefaultTime:function(h){if(!this.$element.val()){if(h==="current"){var f=new Date(),g=f.getHours(),k=f.getMinutes(),l=f.getSeconds(),i="AM";
if(l!==0){l=Math.ceil(f.getSeconds()/this.secondStep)*this.secondStep;if(l===60){k+=1;l=0;}}if(k!==0){k=Math.ceil(f.getMinutes()/this.minuteStep)*this.minuteStep;if(k===60){g+=1;k=0;}}if(this.showMeridian){if(g===0){g=12;}else{if(g>=12){if(g>12){g=g-12;}i="PM";}else{i="AM";}}}this.hour=g;this.minute=k;
this.second=l;this.meridian=i;this.update();}else{if(h===false){this.hour=0;this.minute=0;this.second=0;this.meridian="AM";}else{this.setTime(h);}}}else{this.updateFromElementVal();}},setTime:function(l,i){if(!l){this.clear();return;}var k,f,m,g,h;if(typeof l==="object"&&l.getMonth){f=l.getHours();m=l.getMinutes();
g=l.getSeconds();if(this.showMeridian){h="AM";if(f>12){h="PM";f=f%12;}if(f===12){h="PM";}}}else{if(l.match(/p/i)!==null){h="PM";}else{h="AM";}l=l.replace(/[^0-9\:]/g,"");k=l.split(":");f=k[0]?k[0].toString():k.toString();m=k[1]?k[1].toString():"";g=k[2]?k[2].toString():"";if(f.length>4){g=f.substr(4,2);
}if(f.length>2){m=f.substr(2,2);f=f.substr(0,2);}if(m.length>2){g=m.substr(2,2);m=m.substr(0,2);}if(g.length>2){g=g.substr(2,2);}f=parseInt(f,10);m=parseInt(m,10);g=parseInt(g,10);if(isNaN(f)){f=0;}if(isNaN(m)){m=0;}if(isNaN(g)){g=0;}if(this.showMeridian){if(f<1){f=1;}else{if(f>12){f=12;}}}else{if(f>=24){f=23;
}else{if(f<0){f=0;}}if(f<13&&h==="PM"){f=f+12;}}if(m<0){m=0;}else{if(m>=60){m=59;}}if(this.showSeconds){if(isNaN(g)){g=0;}else{if(g<0){g=0;}else{if(g>=60){g=59;}}}}}this.hour=f;this.minute=m;this.second=g;this.meridian=h;this.update(i);},showWidget:function(){if(this.isOpen){return;}if(this.$element.is(":disabled")){return;
}this.$widget.appendTo(this.appendWidgetTo);var f=this;d(a).on("mousedown.timepicker, touchend.timepicker",function(g){if(!(f.$element.parent().find(g.target).length||f.$widget.is(g.target)||f.$widget.find(g.target).length)){f.hideWidget();}});this.$element.trigger({"type":"show.timepicker","time":{"value":this.getTime(),"hours":this.hour,"minutes":this.minute,"seconds":this.second,"meridian":this.meridian}});
this.place();if(this.disableFocus){this.$element.blur();}if(this.hour===""){if(this.defaultTime){this.setDefaultTime(this.defaultTime);}else{this.setTime("0:0:0");}}if(this.template==="modal"&&this.$widget.modal){this.$widget.modal("show").on("hidden",d.proxy(this.hideWidget,this));}else{if(this.isOpen===false){this.$widget.addClass("displayed");
}}this.isOpen=true;},toggleMeridian:function(){this.meridian=this.meridian==="AM"?"PM":"AM";},update:function(f){this.updateElement();if(!f){this.updateWidget();}this.$element.trigger({"type":"changeTime.timepicker","time":{"value":this.getTime(),"hours":this.hour,"minutes":this.minute,"seconds":this.second,"meridian":this.meridian}});
if(ko){ko.utils.triggerEvent(this._element,"propertychange");}},updateElement:function(){this.$element.val(this.getTime()).change();},updateFromElementVal:function(){this.setTime(this.$element.val());},updateWidget:function(){if(this.$widget===false){return;}var f=this.hour;if(!this.showMeridian){f=f.toString().length===1?"0"+f:f;
}var h=this.minute.toString().length===1?"0"+this.minute:this.minute;var g=this.second.toString().length===1?"0"+this.second:this.second;if(this.showInputs){this.$widget.find("input.timepicker-hour").val(f);this.$widget.find("input.timepicker-minute").val(h);if(this.showSeconds){this.$widget.find("input.timepicker-second").val(g);
}if(this.showMeridian){this.$widget.find("input.timepicker-meridian").val(this.meridian);}}else{this.$widget.find("span.timepicker-hour").text(f);this.$widget.find("span.timepicker-minute").text(h);if(this.showSeconds){this.$widget.find("span.timepicker-second").text(g);}if(this.showMeridian){this.$widget.find("span.timepicker-meridian").text(this.meridian);
}}},updateFromWidgetInputs:function(){if(this.$widget===false){return;}var f=this.$widget.find("input.timepicker-hour").val()+":"+this.$widget.find("input.timepicker-minute").val()+(this.showSeconds?":"+this.$widget.find("input.timepicker-second").val():"")+(this.showMeridian?this.$widget.find("input.timepicker-meridian").val():"");
this.setTime(f,true);},widgetClick:function(g){g.stopPropagation();g.preventDefault();var h=d(g.target),f=h.closest("a").data("action");if(f){this[f]();}this.update();if(h.is("input")){h.get(0).setSelectionRange(0,2);}},widgetKeydown:function(g){var h=d(g.target),f=h.attr("class").replace("timepicker-","");
switch(g.keyCode){case 9:if((this.showMeridian&&f==="meridian")||(this.showSeconds&&f==="second")||(!this.showMeridian&&!this.showSeconds&&f==="minute")){return this.hideWidget();}break;case 27:this.hideWidget();break;case 38:g.preventDefault();switch(f){case"hour":this.incrementHour();break;case"minute":this.incrementMinute();
break;case"second":this.incrementSecond();break;case"meridian":this.toggleMeridian();break;}this.setTime(this.getTime());h.get(0).setSelectionRange(0,2);break;case 40:g.preventDefault();switch(f){case"hour":this.decrementHour();break;case"minute":this.decrementMinute();break;case"second":this.decrementSecond();
break;case"meridian":this.toggleMeridian();break;}this.setTime(this.getTime());h.get(0).setSelectionRange(0,2);break;}},widgetKeyup:function(f){if((f.keyCode===65)||(f.keyCode===77)||(f.keyCode===80)||(f.keyCode===46)||(f.keyCode===8)||(f.keyCode>=46&&f.keyCode<=57)){this.updateFromWidgetInputs();}}};
d.fn.timepicker=function(g){var f=Array.apply(null,arguments);f.shift();return this.each(function(){var k=d(this),i=k.data("timepicker"),h=typeof g==="object"&&g;if(!i){k.data("timepicker",(i=new b(this,d.extend({},d.fn.timepicker.defaults,h,d(this).data()))));}if(typeof g==="string"){i[g].apply(i,f);
}});};d.fn.timepicker.defaults={defaultTime:"current",disableFocus:false,disableMousewheel:false,isOpen:false,minuteStep:15,modalBackdrop:false,orientation:{x:"auto",y:"auto"},secondStep:15,showSeconds:false,showInputs:true,showMeridian:true,template:"dropdown",appendWidgetTo:"body",showWidgetOnAddonClick:true};
d.fn.timepicker.Constructor=b;})(jQuery,window,document);!function(b){var c=function(e,d){this.$element=b(e);this.options=b.extend({},b.fn.typeahead.defaults,d);this.matcher=this.options.matcher||this.matcher;this.sorter=this.options.sorter||this.sorter;this.highlighter=this.options.highlighter||this.highlighter;
this.updater=this.options.updater||this.updater;this.source=this.options.source;this.$menu=b(this.options.menu);this.shown=false;this.listen();var f=this;this.tokenised=this.options.tokenised||false;this._value=this.options._value||[];};c.prototype={constructor:c,select:function(){var e=this.$menu.find(".active").attr("data-value");
this.$element.val(this.updater(e)).change();if(this.tokenised){var d=e;if(e.indexOf("{")>=0){d=JSON.parse(e);}this._value.push(d);this.$element.val(this.updater("")).change();}else{this._value[0]=e;}return this.hide();},value:function(){if(this.tokenised){return this._value;}else{return this.$element.val();
}},findInArray:function(h,g){var d=-1;if(typeof(h)==="function"){for(var e=0;e<h().length;e++){var f=h()[e];if(f===g){d=e;break;}}}else{for(var e=0;e<h.length;e++){var f=h[e];if(f===g){d=e;break;}}}return d;},removeToken:function(e){var d=this.findInArray(this._value,e);if(d>=0){this._value.splice(d,1);
}return d;},updater:function(d){return d;},show:function(){var k=b.extend({},this.$element.position(),{height:this.$element[0].offsetHeight});this.$menu.insertAfter(this.$element);this.$menu.show();var f=0;var d=this.$element[0].getBoundingClientRect();var g=d.top;var i=this.$menu.height();var h=window.innerHeight-(g+k.height);
if(h<i){f=i+16;}var e=f>0?k.top-f:k.top+k.height;this.$menu.css({top:e,left:k.left});this.shown=true;return this;},hide:function(){this.$menu.hide();this.shown=false;return this;},lookup:function(e){var d;this.query=this.$element.val();if((undefined===this.query)||(this.query.length<this.options.minLength)){return this.shown?this.hide():this;
}d=b.isFunction(this.source)?this.source(this.query,b.proxy(this.process,this)):this.source;return d?this.process(d):this;},process:function(d){var e=this;d=b.grep(d,function(f){return e.matcher(f);});d=this.sorter(d);if(!d.length){return this.shown?this.hide():this;}return this.render(d.slice(0,this.options.items)).show();
},getItemValue:function(d){return d.key?d.key:d;},matcher:function(e){var d=this.getItemValue(e);return ~d.toLowerCase().indexOf(this.query.toLowerCase());},sorter:function(f){var g=[],e=[],d=[],i;while(i=f.shift()){var h=this.getItemValue(i);if(!h.toLowerCase().indexOf(this.query.toLowerCase())){g.push(i);
}else{if(~h.indexOf(this.query)){e.push(i);}else{d.push(i);}}}return g.concat(e,d);},highlighter:function(e){var f=this.query.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&");var d=this.getItemValue(e);return d.replace(new RegExp("("+f+")","ig"),function(g,h){return"<strong>"+h+"</strong>";});},render:function(d){var e=this;
d=b(d).map(function(g,h){var k=h;var f=h;if(h.key){k=JSON.stringify(h);f=h.key;}g=b(e.options.item).attr("data-value",k);g.find("a").html(e.highlighter(f));return g[0];});d.first().addClass("active");this.$menu.html(d);return this;},next:function(e){var f=this.$menu.find(".active").removeClass("active"),d=f.next();
if(!d.length){d=b(this.$menu.find("li")[0]);}d.addClass("active");},prev:function(e){var f=this.$menu.find(".active").removeClass("active"),d=f.prev();if(!d.length){d=this.$menu.find("li").last();}d.addClass("active");},listen:function(){this.$element.on("focus",b.proxy(this.focus,this)).on("blur",b.proxy(this.blur,this)).on("keypress",b.proxy(this.keypress,this)).on("keyup",b.proxy(this.keyup,this));
if(this.eventSupported("keydown")){this.$element.on("keydown",b.proxy(this.keydown,this));}this.$menu.on("click",b.proxy(this.click,this)).on("mouseenter","li",b.proxy(this.mouseenter,this)).on("mouseleave","li",b.proxy(this.mouseleave,this));},eventSupported:function(d){var e=d in this.$element;if(!e){this.$element.setAttribute(d,"return;");
e=typeof this.$element[d]==="function";}return e;},move:function(d){if(!this.shown){return;}switch(d.keyCode){case 9:case 13:case 27:d.preventDefault();break;case 38:d.preventDefault();this.prev();break;case 40:d.preventDefault();this.next();break;}d.stopPropagation();},keydown:function(d){this.suppressKeyPressRepeat=~b.inArray(d.keyCode,[40,38,9,13,27]);
this.move(d);},keypress:function(d){if(this.suppressKeyPressRepeat){return;}this.move(d);},keyup:function(d){switch(d.keyCode){case 40:if(!this.shown){this.lookup();}break;case 38:case 16:case 17:case 18:break;case 9:case 13:if(!this.shown){return;}this.select();break;case 27:if(!this.shown){return;}this.hide();
break;default:this.lookup();}d.stopPropagation();d.preventDefault();},focus:function(d){this.focused=true;},blur:function(d){this.focused=false;if(!this.mousedover&&this.shown){this.hide();}},click:function(d){d.stopPropagation();d.preventDefault();this.select();this.$element.focus();},mouseenter:function(d){this.mousedover=true;
this.$menu.find(".active").removeClass("active");b(d.currentTarget).addClass("active");},mouseleave:function(d){this.mousedover=false;if(!this.focused&&this.shown){this.hide();}},showMenu:function(){if(!this.shown){this.$element.focus();this.lookup();}}};var a=b.fn.typeahead;b.fn.typeahead=function(d){return this.each(function(){var g=b(this),f=g.data("typeahead"),e=typeof d=="object"&&d;
if(!f){g.data("typeahead",(f=new c(this,e)));g.data("widget",f);}if(typeof d=="string"){f[d]();}});};b.fn.typeahead.defaults={source:[],items:8,menu:'<ul class="typeahead dropdown-menu"></ul>',item:'<li><a href="#"></a></li>',minLength:0};b.fn.typeahead.Constructor=c;}(window.jQuery);(function(a){a.newBinding=function(b){b=phil.isFunc(b)?b():b;
var c=function(){return b;};c["get"]=function(d){return b[d];};c["has"]=function(d){return d in b;};return c;};a.addAriaAttrs=function(b,c){b.setAttribute("alt",c);};a.getDataForSrcEl=function(c){var b=event.srcElement;var d=ko.dataFor(b);return d;};a.callAndApply=function(c,b){c.apply(this,b);};a.applyCssBindings=function(c,d){if(!d){return -2;
}if(!d.status||!d.enabled||!d.hidden){return -1;}var b=ko.utils.unwrapObservable(d.status);if(b===0){ko.bindingHandlers.css.update(c,function(){return"";});}else{if(b>0){ko.bindingHandlers.css.update(c,function(){return"is-success";});}else{if(b<0&&b>=-1){ko.bindingHandlers.css.update(c,function(){return"is-warning";
});}else{if(b<-1){ko.bindingHandlers.css.update(c,function(){return"is-error";});}}}}ko.utils.toggleDomNodeCssClass(c,"disabled",!d.enabled());ko.utils.toggleDomNodeCssClass(c,"concealed",d.hidden());return this;};a.findByAttr=function(c,b,g){var e=undefined;var f=ko.utils.peekObservable(c);for(var d=0;
d<f.length;d++){if(f[d][b]===g){e=f[d];break;}}return e;};a.getKeys=function(d){if(Object.keys){return Object.keys(d);}var c=[];for(var b in d){c.push(b);}return c;};a.getWidthClass=function(c){var d="";var e=c.className.indexOf("width");if(e>=-1){d=c.className.substring(e);var b=d.indexOf(" ");if(b>=-1){d=d.substring(0,b);
}}return d;};a.makeEventHandlerShortcut=function(b){ko.bindingHandlers[b]={"init":function(f,g,h,e,d){var c=function(){var i={};i[b]=g();return i;};return ko.bindingHandlers["event"]["init"].call(this,f,c,h,e,d);}};};a.toggleEnabledBindings=function(c,e,d,b){if(!e.enabled){return -1;}ko.bindingHandlers.enable.update(c,e.enabled,d,b);
ko.utils.toggleDomNodeCssClass(c,"disabled",!e.enabled());};a.createLabel=function(d,e){if(!e.label){return -1;}var c=$(d);var b=$('<p class="smartlabel heightauto is-info inline-block">'+e.label.value()+"</p>");c.before(b);return b;};a.updateLabel=function(c,d){if(!c){return -1;}var b=$(c);if(d.hidden()){b.addClass("concealed");
}else{b.removeClass("concealed");}};a.toggleError=function(d,f){if(!f.status||!f.errorMsg){return -1;}var c=f.status();var e=f.errorMsg();var b=$(d);if(!e||e===""){return;}$sibling=b.next();if($sibling.hasClass("is-warning")){$sibling.detach();}if(c<0){b.after('<p class="p is-warning width10">'+e+"</p>");
}};a.setAttr=function(c,b,d){if(!d){return -1;}c.setAttribute(b,d);};a.makeEventHandlerShortcut=function(b){ko.bindingHandlers[b]={"init":function(f,g,h,e,d){var c=function(){var i={};i[b]=g();return i;};return ko.bindingHandlers["event"]["init"].call(this,f,c,h,e,d);}};};})(__ns("phil.utils"));ko.virtualElements.allowedBindings.book=true;
ko.bindingHandlers.book={tmpl:function(){if($("#book").length===0){var a=[,"<!-- ko if:$data._book -->",'<div class="book">','<p data-bind="html:$data._label" class="is-title"></p>',"<!-- ko if:!$data._children || $data._children().length !== 0 -->","<!-- ko book:$data --><!-- /ko -->","<!-- /ko -->","</div>","<!-- /ko -->","<!-- ko if:$data._card -->",'<div class="card" data-bind="css:{\'collapsed\':$data.collapsed}">','<div data-bind="card:$data, attr:{name:$data._card}"></div>',"<!-- ko if:!$data._children || $data._children().length !== 0 -->","<!-- ko book:$data --><!-- /ko -->","<!-- /ko -->","</div>","<!-- /ko -->","<!-- ko if:!$data._card && !$data._book -->","<!-- ko if:!$data._children || $data._children().length !== 0 -->","<!-- ko book:$data --><!-- /ko -->","<!-- /ko -->","<!-- /ko -->"].join("");
$("body").prepend('<script type="text/phil" id="book">'+a+"<\/script>");}},accessor:function(a){return function(){var c=a(),b=ko.utils.peekObservable(c);ko.utils.unwrapObservable(c);if(!b){var d=1;}var e=b._children;if(!b._children){e=b.data;}return{"foreach":e,"templateEngine":ko.nativeTemplateEngine.instance,"name":"book","afterRender":c.afterRender};
};},init:function(c,e,f,b,a){var g=ko.utils.unwrapObservable(e());ko.bindingHandlers.book.tmpl();var d=ko.bindingHandlers.book.accessor(e);ko.bindingHandlers.template.init(c,d);return{controlsDescendantBindings:true};},update:function(c,e,f,b,a){var g=ko.utils.unwrapObservable(e());var d=ko.bindingHandlers.book.accessor(e);
ko.bindingHandlers.template.update(c,d,f,b,a);return{controlsDescendantBindings:true};}};ko.bindingHandlers.button={value:function(a){if(!a){return function(){return"-button-";};}return a.value;},makebutton:function(e,d){var c=$(d),b=e(),a=ko.utils.peekObservable(b);if((a!==undefined)&&(a.onblur)){c.on("blur",a.onblur);
}},init:function(c,d,e,b,a){var g=ko.utils.unwrapObservable(d());var f=function(){return function(k,i){var h=d();h.trigger("click",h,i,b);if(h.handler){h.handler.call(k,k,i);}};};ko.bindingHandlers.button.makebutton(d,c);ko.bindingHandlers.value.init(c,ko.bindingHandlers.button.value(g),e,b,a);ko.bindingHandlers.click.init(c,f,e,b,a);
},update:function(d,e,f,c,a){var g=ko.utils.unwrapObservable(e());ko.bindingHandlers.html.update(d,ko.bindingHandlers.button.value(g),f,c,a);var b=g?g.enabled:function(){return true;};ko.bindingHandlers.enable.update(d,b,f,c,a);ko.utils.toggleDomNodeCssClass(d,"disabled",!b());phil.utils.applyCssBindings(d,g);
},};ko.bindingHandlers.buttonmenu={menuAccessor:function(b,a){return function(){var d=b(),c=ko.utils.peekObservable(d);ko.utils.unwrapObservable(d);var e=c["menu"];$(a).on("focus",function(f){$(this).addClass("displayed");});$(a).on("blur",function(f){$(this).removeClass("displayed");});return e;};},buttonAccessor:function(b,a){return function(){var f=a,d=b(),c=ko.utils.peekObservable(d);
ko.utils.unwrapObservable(d);var e=c["button"];e.handler=function(h,g){b().button.onmenushow.call(b(),h,g);var i=$(a).find(".menu");$(i).triggerHandler("focus");$(i).focus();};return e;};},init:function(f,h,e,c,g){var a=$(f).find('button[class~="btn"]')[0];var d=ko.bindingHandlers["buttonmenu"].buttonAccessor(h,f);
ko.bindingHandlers["button"].init(a,d,e,c,g);var b=$(f).find('ul[class~="menu"]')[0];var i=ko.bindingHandlers["buttonmenu"].menuAccessor(h,b);ko.bindingHandlers["menu"].init(b,i,e,c,g);return{controlsDescendantBindings:true};},update:function(f,h,e,c,g){var a=$(f).find('button[class~="btn"]')[0];var d=ko.bindingHandlers["buttonmenu"].buttonAccessor(h,f);
ko.bindingHandlers["button"].update(a,d,e,c,g);var b=$(f).find('ul[class~="menu"]')[0];var i=ko.bindingHandlers["buttonmenu"].menuAccessor(h,f);ko.bindingHandlers["menu"].update(b,i,e,c,g);return{controlsDescendantBindings:true};},};ko.bindingHandlers.capture={processOptions:function(a){a=a||{};var b={selectable:false};
if(phil.isObject(a)){b.select=a.select||false;b.collection=a.collection||{};b.click=a.click||undefined;}return b;},select:function(b,a){var c=phil.utils.getDataForSrcEl(b);phil.mixins.select(c,a);},callAndApply:function(b,a){if(b.click){if(b.collection){a.push(b.collection._values);}phil.utils.callAndApply.call(this,b.click,a);
}},init:function(f,g,h,e,b){var c=g();var a=ko.utils.peekObservable(c);var d=ko.bindingHandlers.capture.processOptions(a);f.addEventListener("click",function(i){phil.stopPropagation(i);ko.bindingHandlers.capture.select(f,d);ko.bindingHandlers.capture.callAndApply(d,Array.from(arguments));});},update:function(c,d,e,b,a){}};
ko.bindingHandlers.cardbundle={makeCardAccessor:function(a){return function(){var c=a(),b=ko.utils.peekObservable(c);ko.utils.unwrapObservable(c);return{"foreach":b["filtered"],"templateEngine":ko.nativeTemplateEngine.instance,"name":b["tmpl"]};};},init:function(c,e,f,b,a){var d=ko.bindingHandlers["cardbundle"].makeCardAccessor(e);
ko.bindingHandlers.template.init(c,d);return{controlsDescendantBindings:true};},update:function(c,e,f,b,a){var d=ko.bindingHandlers["cardbundle"].makeCardAccessor(e);ko.bindingHandlers.template.update(c,d,f,b,a);return{controlsDescendantBindings:true};}};ko.bindingHandlers.cardhost={init:function(f,g,h,e,c){var a=g();
var b=$(f);a.foreach=e.cards=ko.observableArray([]);e.cards.addCard=function(i){var l=i.type.replace(/\./g,"_");if(phil.cards[l]){__mixin(i,phil.cards[l]);}try{this.push(i);}catch(k){the.log.error(this,"Unable to add Card ["+k+"]");if(the.log.getLogLevel()===4){k["get stack"]();}}return i;};var d=$(f).cardhost({locale:e.locale,cards:e.cards,addCapability:e.pump.addCapability,pulse:e.pump.pulse,pulsed:e.pump.pulsed,profiles:a.cards});
c.$root._ready.subscribe(function(){var i=d.data("instance");i.postinit();});ko.bindingHandlers.template.init(f,g,h,e,c);return{controlsDescendantBindings:false};},update:function(c,d,e,b,a){ko.bindingHandlers.template.update(c,d,e,b,a);}};ko.bindingHandlers.card={init:function(c,e,f,b,a){var g=ko.utils.unwrapObservable(e());
var d=function(){g.templateEngine=ko.nativeTemplateEngine.instance;g.name=g.tmpl();return g;};if(g["_action"]&&g["_action"]["default"]===true){$(c).click(function(h){this.btnDefaultAction.handler.call(this,c,h);}.bind(g));}ko.bindingHandlers.template.init(c,d);return{controlsDescendantBindings:true};
},update:function(c,e,f,b,a){var g=ko.utils.unwrapObservable(e());var d=function(){g.templateEngine=ko.nativeTemplateEngine.instance,g.name=g.tmpl();return g;};ko.bindingHandlers.template.update(c,d,f,b,a);return{controlsDescendantBindings:true};}};ko.bindingHandlers.cards={makeCardAccessor:function(a){return function(){var d=a(),b=ko.utils.peekObservable(d);
ko.utils.unwrapObservable(d);var e=b["filtered"]||b["cards"];if(!e){e=b["data"];}var c=e;var f=b["tmpl"]||phil.tmplCard;return{"foreach":c,"templateEngine":ko.nativeTemplateEngine.instance,"name":f};};},init:function(c,e,g,b,a){var d=ko.bindingHandlers["cards"].makeCardAccessor(e);ko.bindingHandlers.template.init(c,d);
var f=a.createChildContext(a.$rawData,null,function(h){ko.utils.extend(h,e());});return{controlsDescendantBindings:true};},update:function(c,e,f,b,a){var d=ko.bindingHandlers["cards"].makeCardAccessor(e);ko.bindingHandlers.template.update(c,d,f,b,a);return{controlsDescendantBindings:true};}};ko.virtualElements.allowedBindings.cards=true;
ko.bindingHandlers.contact={createTemplates:function(){phil.injectTmpl("part-contact","<div >"+'<div class="span span2-pad style="min-width:160px;max-width:240px;">'+'<img data-bind="attr:{\'src\':$data.photo}" class="contact-img" style="max-width:100%">'+'<p data-bind="html:$data.username" class="font12 contact-username"></p>'+'<p data-bind="html:$data.relation" class="font12 contact-relation"></p>'+'<p data-bind="html:$data.fadr" class="font12 contact-fadr"></p>'+'<!-- ko if:$data.lastLogin!=="" -->'+'<p data-bind="html:$data.lastLogin" class="font12 contact-lastlogin"></p>'+"<!-- /ko -->"+"</div>"+'<div class="span span2-pad" style="min-width:160px;max-width:240px;">'+'<div data-bind="foreach:$data.tel">'+'<p><a data-bind="html:$data.display,attr:{href:$data.tel}" class="font12 contact-tel"></a></p>'+"</div>"+'<div data-bind="foreach:$data.email">'+'<p data-bind="html:$data" class="font12 is-info contact-email"></p>'+"</div>"+"</div>"+"</div>");
},init:function(c,d,e,b,a){ko.bindingHandlers["contact"].createTemplates();var f=ko.utils.unwrapObservable(d());},update:function(c,d,e,b,a){var f=ko.utils.unwrapObservable(d());},};ko.bindingHandlers.contactcollection={createTemplates:function(b){ko.bindingHandlers["contact"].createTemplates();var a=b.select!==2?"concealed":"";
var a="";phil.injectTmpl("card-contactcollection","<div name=\"ContactCollection\" data-bind=\"css:{ 'concealed':oVisible()===false, 'selected':oSelected()===true, 'compact':oExpanded()===0 }\" class=\"card list width10-nopad\">"+'<div class="width7 reduceat3 align-left">'+'<button data-bind="click:$data.oFlipSelected, css:{ \'active\':$data.oSelected()===true }" name="select" type="button" class="contact-select btn btn-boolean width1 height2 '+a+'" style="max-width:32px;"></button>'+'<span class="img-wrapper"><img data-bind="attr:{\'src\':$data.photo}" class="contact-profile img img32x32"/></span>'+'<p data-bind="html:$data.label" class="contact-label is-info height2 align-top align-left inline-block width5 text-clip" style="margin-left:4px;">...</p>'+'<span data-bind="foreach:$data.relation" class="spn lvl2" style="width:28%;">'+'<p data-bind="html:$data" class="is-small is-tag is-success height1 widthauto text-clip">[relation]</p>'+"</span>"+"</div>"+'<div class="width3 align-top align-right">'+"<!-- ko if:$data.link -->"+'<button data-bind="attr:{\'disabled\':!$data.link.chat}" name="chat" class="contact-btn1 btn is-primary width4">chat</button>'+'<button data-bind="attr:{\'disabled\':!$data.link.visit}" name="visit" class="contact-btn2 btn is-info width4">visit</button>'+'<button data-bind="click:$data.oFlipExpanded" name="expand" class="contact-expand btn is-default width2" style="max-width:32px;"><span class="ico ico-caron"></span></button>'+"<!-- /ko -->"+"</div>"+"<div data-bind=\"with:$data, css:{ 'concealed':oExpanded()===0 }\" >"+phil.insertTmpl("part-contact")+"</div>"+"</div>");
},init:function(c,d,e,b,a){var f=ko.utils.unwrapObservable(d());ko.bindingHandlers["contactcollection"].createTemplates(f);f.tmpl="card-contactcollection";ko.utils.registerEventHandler(c,"click",f.propagateEvent);ko.bindingHandlers["cards"].init(c,d,e,b,a);},update:function(c,e,f,b,a){var g=ko.utils.unwrapObservable(e());
var d=$(c).find(".collection-empty");if(e().data().length===0){if(d.length===0){c.innerHTML='<p class="collection-empty">no contacts available</p>';}}else{if(d.length!==0){d.remove();}}ko.bindingHandlers["cards"].update(c,e,f,b,a);},};ko.bindingHandlers.contactlist={createTemplates:function(){phil.injectTmpl("card-contactlist",'<div data-name="select" data-bind="click:oFlipSelected, css:{ \'concealed\':oVisible()===false, \'selected\':oSelected()===true }" class="card list width10 text-clip align-left">'+'<span class="img-wrapper"><img data-name="select" data-bind="attr:{\'src\':$data.photo}" class="img profile"/></span><p data-name="select" data-bind="html:$data.label" class="is-info height2 align-top align-left inline-block widthauto text-clip" style="margin-left:4px;">...</p>'+"</div>");
},init:function(c,d,e,b,a){ko.bindingHandlers["contactlist"].createTemplates();var f=ko.utils.unwrapObservable(d());f.tmpl="card-contactlist";ko.utils.registerEventHandler(c,"click",f.propagateEvent);ko.bindingHandlers["cards"].init(c,d,e,b,a);},update:function(c,e,f,b,a){var g=ko.utils.unwrapObservable(e());
var d=$(c).find(".collection-empty");if(e().data().length===0){if(d.length===0){c.innerHTML='<p class="collection-empty">no contacts available</p>';}}else{if(d.length!==0){d.remove();}}ko.bindingHandlers["cards"].update(c,e,f,b,a);},};phil.model.DatePicker=function(c){c=c||{};var b=phil.model.Element(c);
b._instance="phil.model.DatePicker";var a=[{val:"",lbl:"dd"}];for(var d=1;d<=31;d++){var e=d<=9?"0"+(d):""+(d);a.push({val:d,lbl:e});}var f=[{val:"",lbl:"mm"},{val:0,lbl:"jan"},{val:1,lbl:"feb"},{val:2,lbl:"mar"},{val:3,lbl:"apr"},{val:4,lbl:"may"},{val:5,lbl:"jun"},{val:6,lbl:"jul"},{val:7,lbl:"aug"},{val:8,lbl:"sep"},{val:9,lbl:"oct"},{val:10,lbl:"nov"},{val:11,lbl:"dec"}];
var g=[{val:"",lbl:"yyyy"}];for(var d=-100;d<=10;d++){g.push({val:2017+d,lbl:2017+d});}b.dd=phil.observe(a);b.mm=phil.observe(f);b.yy=phil.observe(g);b.ddValue=phil.observe();b.mmValue=phil.observe();b.yyValue=phil.observe();b.getInitialDate=function(){var i={dd:"",mm:"",yy:""};var k=undefined;if(b.value()===undefined){var k=new Date();
}if(b.value()&&b.value()!==""){var h=b.value().split("-")[0];var k=undefined;if(h.length===4){var k=new Date.parseExact(b.value(),"yyyy-MM-dd");}else{var k=new Date.parse(b.value());}}if(k){b.setDate(k);}else{b.setDate("");}return i;};b.setDate=function(h){b._dt=h;if(!h||h===""){b.value("");}else{b.value(h.toString("yyyy-MM-dd"));
}};b.getDate=function(){var i={dd:"",mm:"",yy:""};var k=b._dt;if(b.value()!==""){var h=b.value().split("-");i.dd=i.dd=k.getDate();i.mm=k.getMonth();i.yy=k.getUTCFullYear();}return i;};b.getDateStats=function(i,n,o){var l={dt:undefined,monthLength:31};if(i!==""&&n!==""&&o!==""){l.dt=new Date(o,n,i);var k=new Date(o,n,1);
var m=new Date(o,n+1,1);var h=(m-k)/86400000;l.monthLength=h;}return l;};b.getInitialDate();return b;};ko.bindingHandlers.datepicker={init:function(c,e,f,b,a){var g=ko.utils.unwrapObservable(e());var d=g.getDate();g.ddValue(d.dd);g.mmValue(d.mm);g.yyValue(d.yy);},update:function(d,f,g,c,a){var h=ko.utils.unwrapObservable(f());
var b=h.getDateStats(h.ddValue(),h.mmValue(),h.yyValue());if((h.ddValue()+1)>b.monthLength){h.ddValue(b.monthLength-1);}if(b.dt!==undefined){h.setDate(b.dt);var e=h.getDate();h.ddValue(e.dd);h.mmValue(e.mm);h.yyValue(e.yy);}}};phil.model.Dialog=function(b){b=b||{};b.hidden=b.hidden||true;var a=phil.model.Element(b);
a._instance="phil.model.Dialog";a._callback=b.callback||function(){};a.close=function(d,c){this.hidden(true);this._callback(d,c,"close");};a.show=function(){this.hidden(false);}.bind(a);return a;};phil.model.DialogFilterList=function(b){b=b||{};var a=phil.model.Dialog(b);a._instance="phil.model.DialogFilterList";
a.select=function(d,c){this._callback(d,c,"select");this.hidden(true);};a.boundTo=b.bindTo||undefined;if(a.boundTo){a.boundTo.listen(b.bindOn,function(e,c,d){this.show();}.bind(a));a.boundTo.listen(b.bindOff,function(e,c,d){this.hidden(true);}.bind(a));a.boundTo.listen("action.enter",function(e,c,d){if(!this.hidden()){this.boundTo.replace(c,this.chooseFocused().value);
this.hidden(true);}}.bind(a));a.boundTo.listen("action.esc",function(e,c,d){this.hidden(true);}.bind(a));a.boundTo.listen("action.up",function(e,c,d){if(!this.hidden()){this.focusPrev();}}.bind(a));a.boundTo.listen("action.down",function(e,c,d){if(!this.hidden()){this.focusNext();}}.bind(a));}a.listAdd=function(c){a.list.add(c);
};a.focus=phil.observe(0);a.focusNext=function(){if(a.focus()>=(a.list().length-1)){a.focus(0);}else{a.focus(a.focus()+1);}};a.focusPrev=function(){if(a.focus()===0){a.focus(a.list().length-1);}else{a.focus(a.focus()-1);}};a.chooseFocused=function(){var c=a.list()[a.focus()];a.close(c);return c;};a.list=phil.collections.List(b.list||[],{mixins:{"Sortable":{key:"label"}}});
return a;};ko.bindingHandlers.dialog={init:function(c,d,e,b,a){var f=ko.utils.unwrapObservable(d());return{controlsDescendantBindings:false};},update:function(c,d,e,b,a){var f=ko.utils.unwrapObservable(d());phil.utils.applyCssBindings(c,f);return{controlsDescendantBindings:false};}};phil.utils.makeEventHandlerShortcut("onkeyup");
ko.bindingHandlers.flip={init:function(d,e,f,c){var a=e();var b=function(){return function(g){if(phil.isFunc(a)){a(!a());}};};ko.bindingHandlers.tap.init(d,b,f,c);}};ko.bindingHandlers.graph={init:function(c,d,f,b,a){var e=ko.utils.unwrapObservable(d());e.createGraph(c);},update:function(c,e,g,b,a){var f=ko.utils.unwrapObservable(e());
phil.utils.applyCssBindings(c,f);f.updateGraph();f.clearPoints();f.clearAxis();var d=f.parseCSV();f.plot(d.ranges);f.plotAxis();}};ko.bindingHandlers.heading={init:function(c,d,e,b,a){var f=ko.utils.unwrapObservable(d());},update:function(c,d,e,b,a){var f=ko.utils.unwrapObservable(d());ko.bindingHandlers.html.update(c,f.value,e,b);
}};ko.bindingHandlers.i18n={init:function(c,d,e,b,a){},update:function(d,e,f,c,a){var g=ko.utils.unwrapObservable(e());function b(){var h=a.$root._i18n||{};return h[g]||g.substring(g.lastIndexOf("-"));}ko.bindingHandlers.html.update(d,b);}};phil.model.Image=function(b){b=b||{};var a=phil.model.Element(b);
a._instance="phil.model.Image";a.fallback=b.fallback||undefined;return a;};ko.bindingHandlers.image={error:function(a,c){var b;if(c.fallback){b=c.fallback;}else{b="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7";}ko.bindingHandlers.attr.update(a,function(){return{"src":b};
});ko.bindingHandlers.attr.update(a,function(){return{"style":"background-color:transparent !important;"};});},init:function(c,d,e,b,a){var f=ko.utils.unwrapObservable(d());$(c).error(function(){ko.bindingHandlers.image.error(c,f);});},update:function(c,d,f,b,a){var g=ko.utils.unwrapObservable(d());function e(){if(!g||!g.value){return{src:g};
}else{return{src:g.value()};}}ko.bindingHandlers.attr.update(c,e);setTimeout(function(){ko.utils.toggleDomNodeCssClass(c,"concealed",false);}.bind(this),1);}};ko.bindingHandlers.input={resizeTextarea:function(a,b){$(a).css("height","initial");if(a.scrollHeight>a.clientHeight){$(a).css("height",a.scrollHeight+"px");
}},useCapture:function(b,a){if(a.capture){$(b).keydown(function(c){a.keydown(c.keyCode,c);});}},init:function(c,e,f,b,a){var g=ko.utils.unwrapObservable(e());ko.bindingHandlers.input.useCapture(c,g);var d=function(){return g.value;};ko.bindingHandlers.textInput.init(c,d,f,b);if($(c).hasClass("resizeable")){g.value.subscribe(function(){ko.bindingHandlers.input.resizeTextarea(c);
});}},update:function(c,d,e,b,a){var f=ko.utils.unwrapObservable(d());phil.utils.toggleEnabledBindings(c,f,e,b);phil.utils.toggleError(c,f);phil.utils.setAttr(c,"placeholder",ko.utils.unwrapObservable(f.placeholder));phil.utils.applyCssBindings(c,f);if($(c).hasClass("resizeable")){ko.bindingHandlers.input.resizeTextarea(c);
}}};ko.bindingHandlers.label={init:function(c,d,e,b,a){var f=ko.utils.unwrapObservable(d());},update:function(c,d,f,b,a){var g=ko.utils.unwrapObservable(d());var e=function(){return"-label-";};if(g){phil.utils.applyCssBindings(c,g);e=function(){return phil.escape(g.value());};}ko.bindingHandlers.html.update(c,e);
}};ko.bindingHandlers.list={accessor:function(b){var a=b();if(a.filtered){return a.filtered();}else{if(a.sorted){return a.sorted();}else{return b;}}},init:function(d,e,f,c,b){var g=ko.utils.unwrapObservable(e);var a=ko.bindingHandlers.list.accessor(g);ko.bindingHandlers.foreach.init(d,a,f,c,b);return{controlsDescendantBindings:true};
},update:function(d,e,f,c,b){var g=ko.utils.unwrapObservable(e);var a=ko.bindingHandlers.list.accessor(g);ko.bindingHandlers.foreach.update(d,a,f,c,b);return{controlsDescendantBindings:true};}};ko.bindingHandlers.menu={makeMenu:function(b,a){return function(){var e=$(a),d=b(),c=ko.utils.peekObservable(d);
ko.utils.unwrapObservable(d);e.on({focus:function(){},blur:function(){$(this).removeClass("displayed");},mousedown:function(f){f.preventDefault();}});return{"foreach":c["items"],"templateEngine":ko.nativeTemplateEngine.instance};};},init:function(c,d,e,b,a){var f=ko.bindingHandlers["menu"].makeMenu(d,c);
ko.bindingHandlers.template.init(c,f);return{controlsDescendantBindings:true};},update:function(c,d,e,b,a){var f=ko.bindingHandlers["menu"].makeMenu(d,c);ko.bindingHandlers.template.update(c,f,e,b,a);return{controlsDescendantBindings:true};}};ko.bindingHandlers.paragraph={init:function(c,d,e,b,a){},update:function(c,d,f,b,a){var g=ko.utils.unwrapObservable(d());
var e=function(){return"-paragraph-";};if(g&&g.value){phil.utils.applyCssBindings(c,g);e=function(){return phil.markupify(phil.escape(g.value()));};}else{e=function(){return phil.markupify(phil.escape(ko.utils.unwrapObservable(g)));};}ko.bindingHandlers.html.update(c,e);}};ko.bindingHandlers.progress={init:function(c,d,e,b,a){var f=ko.utils.unwrapObservable(d());
if(c.innerHTML===""){f._innerHtml='<div class="bar height2"><p></p></div>';}else{f._innerHtml=c.innerHTML;}},update:function(d,e,f,c,a){var g=ko.utils.unwrapObservable(e());var b=g._innerHtml.replace("><p>",' style="width:'+g.progress()+'%"><p>');b=b.replace("<p></p>","<p>"+g.value()+"</p>");ko.bindingHandlers.html.update(d,function(){return b;
});phil.utils.applyCssBindings(d,g);}};ko.bindingHandlers.select={optionsBinding:function(a,c){var b=phil.utils.newBinding(function(){var d=a();d["optionsCaption"]=c;d["optionsText"]="text";d["optionsValue"]="value";return d;});return b;},init:function(c,d,e,b,a){var g=ko.utils.unwrapObservable(d());
var f=ko.bindingHandlers.select.optionsBinding(e,g.placeholder);ko.bindingHandlers.value.init(c,g.value,f,b);ko.bindingHandlers.options.init(c,g.options,f,b);},update:function(c,d,e,b,a){var g=ko.utils.unwrapObservable(d());var f=ko.bindingHandlers.select.optionsBinding(e,g.placeholder);ko.bindingHandlers.value.update(c,g.value,f,b,a);
ko.bindingHandlers.enable.update(c,g.enabled,e,b,a);phil.utils.applyCssBindings(c,g);ko.bindingHandlers.options.update(c,g.options,f,b,a);},};phil.utils.makeEventHandlerShortcut("touchstart");phil.utils.makeEventHandlerShortcut("touchend");phil.utils.makeEventHandlerShortcut("touchmove");phil.utils.makeEventHandlerShortcut("mousedown");
phil.utils.makeEventHandlerShortcut("mouseup");phil.utils.makeEventHandlerShortcut("mousemove");ko.bindingHandlers.tap={init:function(f,i,d,l,g){var q,p,n;var c,h=false;function a(r,s){return/touch/.test(r.type)?(r.originalEvent||r).changedTouches[0]["page"+s]:r["page"+s];}function k(s,r){q=-1;r.philAction="press";
i().call(this,l,r);return true;}function b(){return function(u,r){if(p){var t=a(r,"X")-p;var s=a(r,"Y")-n;if(Math.abs(s)>10){c=true;$(this).trigger("touchend");}else{if(Math.abs(t)>7){h=true;}}clearTimeout(q);}return true;};}function m(){return function(s,r){p=a(r,"X");n=a(r,"Y");c=false;h=false;q=setTimeout(function(){k(s,r);
},2000);return true;};}function e(){return function(s,r){p=undefined;n=undefined;if(phil.hasTouchEvents&&q!==-1){delete (q);if(!c){if(h){r.philAction="swipe";}i().call(this,s,r);}}if(q&&q!==-1){clearTimeout(q);q=undefined;}};}function o(){return function(s,r){if(q){delete (q);}else{if(h){r.philAction="swipe";
}i().call(this,s,r);}};}if(phil.hasTouchEvents){var q=undefined;ko.bindingHandlers.touchstart["init"].call(this,f,m,d,l,g);ko.bindingHandlers.touchmove["init"].call(this,f,b,d,l,g);ko.bindingHandlers.touchend["init"].call(this,f,e,d,l,g);ko.bindingHandlers.click["init"].call(this,f,o,d,l,g);}else{ko.bindingHandlers.mousedown["init"].call(this,f,m,d,l,g);
ko.bindingHandlers.mousemove["init"].call(this,f,b,d,l,g);ko.bindingHandlers.mouseup["init"].call(this,f,e,d,l,g);ko.bindingHandlers.click["init"].call(this,f,o,d,l,g);}}};ko.bindingHandlers.time={init:function(g,i,e,d,h){var b=ko.utils.unwrapObservable(i());var l=$(g);var f=0;b.inlineVisible=phil.observe(false);
b.focus=phil.observe(false);ko.bindingHandlers.input.init(g,i,e,d);l.attr("readonly",true);if(l.attr("data-time-inline")){$parent=l;if(l.parent().attr("data-type")){$parent=l.parent();}$parent.after("<div class='time-inline'></div>");var k=ko.unwrap(b.value);var a=k?the.parseDateTime(ko.unwrap(k.value)):the.dateTime();
var c=$parent.next();if(c.length>=1){$(g).timepicker({template:"modal",appendWidgetTo:c[0],minuteStep:5,showInputs:false,disableFocus:true,showMeridian:false,defaultTime:a});}l.click(function(){f++;b.inlineVisible(true);if(b.focus()===true&&f>1){b.inlineVisible(false);f=0;}});l.focus(function(n,m){b.focus(true);
b.inlineVisible(true);});l.focusout(function(n,m){b.focus(false);if(f===0){b.inlineVisible(false);}});}else{$(g).timepicker({minuteStep:5,showInputs:false,disableFocus:true,showMeridian:false});}},update:function(e,f,g,d,b){var h=ko.utils.unwrapObservable(f());var a=$(e);if(a.attr("data-time-inline")){$parent=a;
if(a.parent().attr("data-type")){$parent=a.parent();}var c=$parent.next();ko.utils.toggleDomNodeCssClass(c[0],"concealed",!h.inlineVisible());}ko.bindingHandlers.input.update(e,f,g,d);}};ko.bindingHandlers.textarea={init:function(c,e,f,b,a){var g=ko.utils.unwrapObservable(e());var d=function(){return g.value;
};ko.bindingHandlers.textInput.init(c,d,f,b);},update:function(c,d,e,b,a){var f=ko.utils.unwrapObservable(d());phil.utils.toggleEnabledBindings(c,f,e,b);phil.utils.toggleError(c,f);c.setAttribute("placeholder",ko.utils.unwrapObservable(f.placeholder));phil.utils.setAttr(c,"placeholder",ko.utils.unwrapObservable(f.placeholder));
phil.utils.applyCssBindings(c,f);}};ko.virtualElements.allowedBindings.tree=true;ko.bindingHandlers.tree={tmpl:function(){if($("#tree").length===0){var a=[,"<!-- ko if:$data._card -->",'<div class="card">','<div data-bind="card:$data, attr:{name:$data._card}"></div>',"<!-- ko if:!$data._children || $data._children().length !== 0 -->","<!-- ko tree:$data --><!-- /ko -->","<!-- /ko -->","</div>","<!-- /ko -->","<!-- ko if:!$data._card -->","<!-- ko if:!$data._children || $data._children().length !== 0 -->","<!-- ko tree:$data --><!-- /ko -->","<!-- /ko -->","<!-- /ko -->"].join("");
$("body").prepend('<script type="text/phil" id="tree">'+a+"<\/script>");}},accessor:function(a){return function(){var c=a(),b=ko.utils.peekObservable(c);ko.utils.unwrapObservable(c);if(!b){var d=1;}var e=b._children;if(!b._children){e=b.data;}return{"foreach":e,"templateEngine":ko.nativeTemplateEngine.instance,"name":"tree","afterRender":c.afterRender};
};},init:function(c,e,f,b,a){var g=ko.utils.unwrapObservable(e());ko.bindingHandlers.tree.tmpl();var d=ko.bindingHandlers.tree.accessor(e);ko.bindingHandlers.template.init(c,d);return{controlsDescendantBindings:true};},update:function(c,e,f,b,a){var g=ko.utils.unwrapObservable(e());var d=ko.bindingHandlers.tree.accessor(e);
ko.bindingHandlers.template.update(c,d,f,b,a);return{controlsDescendantBindings:true};}};ko.bindingHandlers.scrollto={init:function(c,d,e,b,a){},update:function(d,e,g,c,a){var h=ko.utils.unwrapObservable(e());if(h){var b=$(d);b.scrollintoview();var f=e();f(false);}}};phil.model.SmartActor=function(b){var a=phil.model.Paragraph(b);
a._instance="phil.model.SmartActor";a.editmode=phil.observe(false);if(b.label){a.label=phil.model.Label({"value":b.label});}return a;};ko.bindingHandlers.smartactor={tmpl:function(){var a=['<span class="span width10">','<p data-bind="smartactor:$data" class="smartactor heightauto is-primary inline-block"></p>',"</span>",].join("");
return a;},init:function(c,d,e,b,a){var f=ko.utils.unwrapObservable(d());f._labelEl=phil.utils.createLabel(c,f);},update:function(c,e,g,b,a){var h=ko.utils.unwrapObservable(e());phil.utils.updateLabel(h._labelEl,h);var f=f=function(){return"...";};c.setAttribute("data-contact",h.value());if(h){phil.utils.applyCssBindings(c,h);
}var d=$(c).parent()[0];ko.utils.toggleDomNodeCssClass(d,"height2-min",!h.hidden());ko.bindingHandlers.html.update(c,f);}};phil.model.SmartBoolean=function(b){var a=phil.model.Element(b);a._instance="phil.model.SmartBoolean";a.editmode=phil.observe(false);if(b.label){a.label=phil.model.Label({"value":b.label});
}return a;};ko.bindingHandlers.smartboolean={tmpl:function(){var a=['<span data-bind="css:{ height2:!$data.hidden }" class="span width10">','<span data-bind="smartboolean:$data" class="span btn-boolean" style="margin-top:0%;border: 1px solid #eee;"></span>',"</span>",].join("");return a;},init:function(c,d,e,b,a){var f=ko.utils.unwrapObservable(d());
phil.utils.createLabel(c,f);},update:function(c,d,f,b,a){var g=ko.utils.unwrapObservable(d());var e=function(){return"-smartboolean-";};ko.utils.toggleDomNodeCssClass(c,"active",g.value()==="true");phil.utils.addAriaAttrs(c,g.value());if(g){phil.utils.applyCssBindings(c,g);}ko.utils.toggleDomNodeCssClass(c,"height2",!g.hidden());
}};phil.model.SmartDate=function(b){var a=phil.model.Paragraph(b);a._instance="phil.model.SmartDate";a.editmode=phil.observe(false);if(b.label){a.label=phil.model.Label({"value":b.label});}return a;};ko.bindingHandlers.smartdate={tmpl:function(){var a=['<span class="span width10">','<p data-bind="smartdate:$data" class="smartdate heightauto is-primary inline-block"></p>',"</span>",].join("");
return a;},init:function(c,d,e,b,a){var f=ko.utils.unwrapObservable(d());f._labelEl=phil.utils.createLabel(c,f);},update:function(c,e,g,b,a){var h=ko.utils.unwrapObservable(e());phil.utils.updateLabel(h._labelEl,h);var f=f=function(){var k="";if(h&&h.value){var i=the.parseDateTime(h.value(),"yyyy-MM-dd");
if(i&&i!==null){k=i.toString("D");}}return k;};if(h){phil.utils.applyCssBindings(c,h);}var d=$(c).parent()[0];ko.utils.toggleDomNodeCssClass(d,"height2-min",!h.hidden());ko.bindingHandlers.html.update(c,f);}};phil.model.SmartDateTime=function(b){var a=phil.model.Paragraph(b);a._instance="phil.model.SmartDateTime";
a.editmode=phil.observe(false);if(b.label){a.label=phil.model.Label({"value":b.label});}return a;};ko.bindingHandlers.smartdatetime={tmpl:function(){var a=['<span class="span width10">','<p data-bind="smartdatetime:$data" class="smartdatetime heightauto is-primary inline-block"></p>',"</span>",].join("");
return a;},init:function(c,d,e,b,a){var f=ko.utils.unwrapObservable(d());f._labelEl=phil.utils.createLabel(c,f);},update:function(c,e,g,b,a){var h=ko.utils.unwrapObservable(e());phil.utils.updateLabel(h._labelEl,h);var f=f=function(){var k="";if(h&&h.value){var i=the.parseDateTime(h.value());if(i&&i!==null){k=i.toString("D")+", "+i.toString("t");
}}return k;};if(h){phil.utils.applyCssBindings(c,h);}var d=$(c).parent()[0];ko.utils.toggleDomNodeCssClass(d,"height2-min",!h.hidden());ko.bindingHandlers.html.update(c,f);}};phil.model.SmartInput=function(b){var a=phil.model.Input(b);a._instance="phil.model.SmartInput";a.editmode=phil.observe(false);
if(b.label){a.label=phil.model.Label({"value":b.label});}return a;};ko.bindingHandlers.smartinput={init:function(c,d,e,b,a){var f=ko.utils.unwrapObservable(d());f._labelEl=phil.utils.createLabel(c,f);},update:function(c,e,f,b,a){var g=ko.utils.unwrapObservable(e());phil.utils.updateLabel(g._labelEl,g);
if(g){phil.utils.applyCssBindings(c,g);}var d=$(c).parent()[0];ko.utils.toggleDomNodeCssClass(d,"height2-min",!g.hidden());ko.bindingHandlers.value.update(c,g.value);}};phil.model.SmartSnippet=function(b){b=b||{};b.capture=true;var a=phil.model.Input(b);__mixin(a,phil.mixins.Observable());a._instance="phil.model.SmartSnippet";
a.editmode=phil.observe(b.editmode||false);a.showDialog=false;a._caretPosition=0;a.saveBtn=phil.model.Button({value:b.saveBtn||"save"}).listen("click",function(d,c){a.onSave(d,c);}.bind(a));a.mention=b.mention!==undefined?b.mention:true;a.tag=b.tag!==undefined?b.tag:true;a.photo=b.photo!==undefined?b.photo:false;
if(b.label){a.label=phil.model.Label({"value":b.label});}a.getCaretPosition=function(c){var c=c.querySelector("textarea");if(c.selectionStart){a._caretPosition=c.selectionStart;}};a.checkForAccessCharacters=function(c){a.getCaretPosition(c);var d=this.value();this.showDialog=false;this.checkForAt(d);
this.checkForTag(d);};a.checkForAt=function(f){var e=f.match(/@[\w\.]+/g);var c=f.match(/@[\w\.]+ /g);e=e||[];c=c||[];if(e.length>c.length){for(var d=0;d<e.length;d++){if($.inArray(e[d]+" ",c)===-1){a.showDialog=true;this.match=e[d];this.trigger("action.mention",this,e[d],f);}}}else{this.trigger("action.unmention",this,e[d],f);
}};a.checkForTag=function(f){var e=f.match(/#[\w.-_]+/g);var c=f.match(/#[\w.-_]+ /g);e=e||[];c=c||[];if(e.length>c.length){for(var d=0;d<e.length;d++){if($.inArray(e[d]+" ",c)===-1){a.showDialog=true;this.match=e[d];this.trigger("action.tag",this,e[d],f);}}}else{this.trigger("action.untag",this,e[d],f);
}};a.match=undefined;a.onAt=function(d,c){a.showDialog=true;this.trigger("action.mention",this,this.match,this.value());};a.onTag=function(d,c){a.showDialog=true;this.trigger("action.tag",this,this.match,this.value());};a.onPhoto=function(c,d){this.trigger("action.photo",c,d);};a.onSave=function(d,c){this.trigger("action.save",this,c);
};a.replace=function(d,f){var e=this.value();if(d&&d!==""){var c=e.substring(a._caretPosition-d.length);c=c.replace(this.match,f+" ");e=e.substring(0,(a._caretPosition-d.length))+c;}else{e=e+f;}this.match=undefined;this.value(e);};a.keydown=function(c,d){if(a.showDialog){if(c===13){d.preventDefault();
this.trigger("action.enter",this,this.match,this.value());}else{if(c===27){d.preventDefault();this.trigger("action.esc",this,this.match,this.value());}else{if(c===38){d.preventDefault();this.trigger("action.up",this,this.match,this.value());}else{if(c===40){d.preventDefault();this.trigger("action.down",this,this.match,this.value());
}}}}}};return a;};ko.bindingHandlers.smartsnippet={tmpl:function(){var a=['<span class="span">',"<!-- ko if:$data.editmode()===true -->",'<input data-bind="input:$data" class="txt"></input>',"<!-- /ko -->","<!-- ko if:$data.editmode()===false -->",'<p data-bind="paragraph:$data" class=""></p>',"<!-- /ko -->","</span>"].join("");
return a;},init:function(c,e,f,b,a){var g=ko.utils.unwrapObservable(e());var d=c.querySelector(".svg-camera > input");d.addEventListener("change",function(h){if(h.target.files.length==1&&h.target.files[0].type.indexOf("image/")==0){g.onPhoto(h,h.target.files[0]);}},false);},update:function(c,d,e,b,a){var f=ko.utils.unwrapObservable(d());
if(f.value()!==""){f.checkForAccessCharacters(c);}}};phil.model.SmartString=function(b){var a=phil.model.Paragraph(b);a._instance="phil.model.SmartString";a.mask=b.mask||false;a.editmode=phil.observe(false);if(b.label){a.label=phil.model.Label({"value":b.label});}return a;};ko.bindingHandlers.smartstring={tmpl:function(){var a=['<span class="span width10">','<p data-bind="smartstring:$data" class="smartstring heightauto is-primary inline-block"></p>',"</span>",].join("");
return a;},init:function(c,d,e,b,a){var f=ko.utils.unwrapObservable(d());f._labelEl=phil.utils.createLabel(c,f);},update:function(c,e,g,b,a){var h=ko.utils.unwrapObservable(e());phil.utils.updateLabel(h._labelEl,h);var f=f=function(){if(!h){return"";}if(h.mask){return"********";}else{return phil.htmlEncode(phil.escape(h.value()));
}};if(h){phil.utils.applyCssBindings(c,h);}var d=$(c).parent()[0];ko.utils.toggleDomNodeCssClass(d,"height2-min",!h.hidden());ko.bindingHandlers.html.update(c,f);}};phil.model.SmartImage=function(b){b=b||{};b.fallback="data:image/jpeg;base64,/9j/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/sABFEdWNreQABAAQAAABQAAD/4QMraHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjAtYzA2MCA2MS4xMzQ3NzcsIDIwMTAvMDIvMTItMTc6MzI6MDAgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLyIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCBDUzUgTWFjaW50b3NoIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjA4NzE2NEQ4QUUyNTExRTE5MzYzQzhCMDEyRDBGMEVGIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjA4NzE2NEQ5QUUyNTExRTE5MzYzQzhCMDEyRDBGMEVGIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6MDg3MTY0RDZBRTI1MTFFMTkzNjNDOEIwMTJEMEYwRUYiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6MDg3MTY0RDdBRTI1MTFFMTkzNjNDOEIwMTJEMEYwRUYiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz7/7gAOQWRvYmUAZMAAAAAB/9sAhAACAgICAgICAgICAwICAgMEAwICAwQFBAQEBAQFBgUFBQUFBQYGBwcIBwcGCQkKCgkJDAwMDAwMDAwMDAwMDAwMAQMDAwUEBQkGBgkNCwkLDQ8ODg4ODw8MDAwMDA8PDAwMDAwMDwwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAz/wAARCABAAEADAREAAhEBAxEB/8QAgAABAQADAQEAAAAAAAAAAAAAAAkGBwgDBAEBAQADAQEAAAAAAAAAAAAAAAUCAwQBBhAAAQMEAAQFAwUBAAAAAAAAAQIDBAARBQYhMRIHYdOUFlZBUQhxMnITFRQRAAIBAwMDBQEAAAAAAAAAAAABAhEDBDFREyGBkUFxEiIyBf/aAAwDAQACEQMRAD8Av5QCgFAKAUAoBQCgFAKAxvbtnx+m63ltlyd1RMUyXC0kgKdcUQltpJP1WshI/Ws4Qc5JIwu3Fbi5P0Js7X3o7h7ZNekPbFLxMNSiY+Kxjy4rLab3CT/WUqWR91kmq0MeEVoQrmVcm9aew1TvR3D1OazIZ2KXloaVAyMVk3lymXE3uUj+wqUgn7oINJ48JLQW8q5B619yk2o7Pj9y1vE7LjLpiZVkOBpRBU04klLjSiPqhYKT+lSZwcJNMu2riuRUl6mSVgZigFAKA5w/KSS6x21jtNhRRNzUVl+3LoDT7ovw5dTYrrw19+xw/wBB0t9yd9VCKKAoh+Lcl1/trIacCgiFmpTLF+XQWmHTbhy6nDUvMX37Fr+e62+50fXIdwoBQCgNad3dMd3rQ8zg4gScmgImYnq5GRHPUEeHWnqRf6dVbrFz4TTNGTa5LbS1JXvMux3XWH21MvsLU280sFKkrSbKSoHiCCLGrJ881QNNOvutsMNqeeeUEMsoBUpalGyUpSOJJPAAUBVDtFpjui6HhsHLCRk1hczLdPISJB6ijx6E9KL/AF6ajX7nzm2fQ41rjtpPU2XWk3igFAKAxvYdw1fVGDI2LPQ8SgC6UPugOr/g0LrWfBINZxtylojXO7GH6dCbXeTZtQ23dJeb0+E/GjSW0/6Mh1IbTKkgkF9DXNPUm178SeJAN71seEoRpIh5VyE51iOzezahqW6RM3uEJ+TGjNq/zpDSQ4mLJJAD62uaulN7W4g8QCbWZEJTjSIxbkITrIpLr24avtbAka7noeWQRdSGHQXUfzaNloPgoCpMrco6ouQuxn+XUySsDYKA+WbNi42HLyE59MaFBZXIlyF/tbabSVLUfAAE16lV0R42kqsnp3F/InbdnlyoWsSndY15KlIYMc9E19HILdeBJQTz6WyLciVc6qWsWMderIt/NnN0j0Rz08+9JdckSHlyH3lFTrziitalHmVKNyTXUcTdTyoBQHqy+9GdbkR3lx32VBTTzaihaVDkUqFiDQJ0Ohe3X5E7brEyLD2eW7s2ulSUP/8AQeuYwjkVtPGylkc+lZN+QKedct3FjLToztsZs4OkuqKFwpsXJQ4mQgvpkwpzKJESQj9rjTiQpCh4EEGpbVHRlpNNVRrrvOxPldsNujYxh+VNkRW22o8ZCnHVhT7YWlKUAk3Te9hyrbjtK4qmjKTdqVCa3snc/iOa9BI8uq3JHdELins/A9k7n8RzXoJHl05I7ocU9n4Hsnc/iOa9BI8unJHdDins/A9k7n8RzXoJHl05I7ocU9n4Hsnc/iOa9BI8unJHdDins/A9k7n8RzXoJHl05I7ocU9n4KU9mGJ8XthqMbJsPxZseK427HkoU26gJfcCEqSsAiybWuOVSchp3HQu4qatRqbPrSdAoBQCgFAKAUAoD//Z";
var a=phil.model.Image(b);a._instance="phil.model.SmartImage";a.editmode=phil.observe(false);if(b.label){a.label=phil.model.Label({"value":b.label||""});}return a;};ko.bindingHandlers.smartimage={tmpl:function(){var a=['<!-- ko if:$data.value()!=="" -->','<span class="span width10">','<div><img data-bind="smartimage:$data" class="img constrain-width"></img></div>',"</span>","<!-- /ko -->"].join("");
return a;},alt:function(a,b){if(!b.label){return -1;}ko.bindingHandlers.attr.update(a,function(){return{"alt":b.label.value()};});},init:function(c,d,e,b,a){var f=ko.utils.unwrapObservable(d());ko.bindingHandlers.image.init(c,d,e,b,a);f._labelEl=phil.utils.createLabel(c,f);ko.bindingHandlers.smartimage.alt(c,f);
},update:function(c,d,f,b,a){var g=ko.utils.unwrapObservable(d());phil.utils.updateLabel(g._labelEl,g);var e=function(){return"-smartimage-";};if(g){phil.utils.applyCssBindings(c,g);e=g.value;}ko.bindingHandlers.image.update(c,d);}};phil.model.SmartParagraph=function(b){var a=phil.model.Paragraph(b);
a._instance="phil.model.SmartParagraph";a.editmode=phil.observe(false);if(b.label){a.label=phil.model.Label({"value":b.label});}return a;};ko.bindingHandlers.smartparagraph={tmpl:function(){var a=['<span class="span width10">','<p data-bind="smartparagraph:$data" class="smartparagraph heightauto is-primary inline-block"></p>',"</span>",].join("");
return a;},init:function(c,d,e,b,a){var f=ko.utils.unwrapObservable(d());phil.utils.createLabel(c,f);},update:function(c,d,e,b,a){var f=ko.utils.unwrapObservable(d());value=function(){return phil.markupify(phil.escape(f.value()));};ko.bindingHandlers.html.update(c,value);}};phil.model.SmartTime=function(b){var a=phil.model.Paragraph(b);
a._instance="phil.model.SmartTime";a.editmode=phil.observe(false);if(b.label){a.label=phil.model.Label({"value":b.label});}return a;};ko.bindingHandlers.smarttime={tmpl:function(){var a=['<span class="span width10">','<p data-bind="smarttime:$data" class="smarttime heightauto is-primary inline-block"></p>',"</span>",].join("");
return a;},init:function(c,d,e,b,a){var f=ko.utils.unwrapObservable(d());f._labelEl=phil.utils.createLabel(c,f);},update:function(c,e,g,b,a){var h=ko.utils.unwrapObservable(e());phil.utils.updateLabel(h._labelEl,h);var f=f=function(){var k="";if(h&&h.value){var i=the.parseDateTime(h.value());if(i&&i!==null){k=i.toString("t");
}}return k;};if(h){phil.utils.applyCssBindings(c,h);}var d=$(c).parent()[0];ko.utils.toggleDomNodeCssClass(d,"height2-min",!h.hidden());ko.bindingHandlers.html.update(c,f);}};ko.bindingHandlers.stylesheet={_requests:phil.observe({}),cache:function(b,c){var a=ko.bindingHandlers.stylesheet._requests();
a[b]=c;ko.bindingHandlers.stylesheet._requests(a);},request:function(a){var b=ko.bindingHandlers.stylesheet._requests()[a];if(!b){ko.bindingHandlers.stylesheet.cache(a,"<!--requesting-->");$.ajax({url:a,context:this}).done(function(d,e,c){ko.bindingHandlers.stylesheet.cache(a,d);}).fail(function(c,e,d){console.log("phil-stylesheet-binding: CSS not found");
});}},applyCss:function(c,a){var b=ko.bindingHandlers.stylesheet._requests()[a];if(b&&b!=="<!--requesting-->"&&c.innerHTML===""){c.innerHTML=b;}},init:function(b,c,d,a){ko.bindingHandlers.stylesheet.request(c());},update:function(c,d,e,b,a){ko.bindingHandlers.stylesheet.applyCss(c,d());}};ko.bindingHandlers.scattergraph={margin:{top:10,left:40,bottom:10,right:0},size:function(b){var a=b.offsetHeight|320;
var c=b.offsetWidth|320;return{"width":c,"height":a};},clearAxis:function(a){a.selectAll(".axis").remove();},getTick:function(a){if(a==="min"){return d3.time.minutes;}if(a==="hour"){return d3.time.hours;}if(a==="day"){return d3.time.days;}if(a==="week"){return d3.time.weeks;}return d3.time.days;},getFormat:function(a){if(a==="minute"){return d3.time.format("%H %M");
}if(a==="hour"){return d3.time.format("%H");}if(a==="day"){return d3.time.format("%a %d");}if(a==="week"){return d3.time.format("%d/%m/%y");}return d3.time.format("%a %d");},drawXAxis:function(g,b,d,f,a){var h=ko.bindingHandlers.scattergraph.getFormat(a);var c=5;var e=d3.svg.axis().scale(b).orient("bottom").ticks(c).tickFormat(h).tickSize(1,1).tickPadding(8);
g.append("g").attr("class","x axis").attr("transform","translate(0, "+(d.height-f.top-f.bottom-f.top)+")").call(e);},drawYAxis:function(f,a,d,e,b){var c=d3.svg.axis().scale(a).orient("left").tickFormat(function(g){return g+"";}).tickSize(1,1).ticks(4);f.append("g").attr("class","y axis").attr("transform","translate(0, 0)").call(c).append("text");
},init:function(d,e,g,c,a){var h=ko.utils.unwrapObservable(e());var b=ko.bindingHandlers.scattergraph.size(d);var f=ko.bindingHandlers.scattergraph.margin;h.graph=d3.select(d).append("svg").attr("class","graph").attr("width",b.width).attr("height",b.height).append("g").attr("transform","translate("+f.left+","+f.top+")").attr("height",b.height-f.top-f.bottom);
},update:function(k,m,h,d,l){var r=ko.bindingHandlers.scattergraph.size(k);var e=ko.bindingHandlers.scattergraph.margin;var c=ko.utils.unwrapObservable(m());var i=ko.utils.unwrapObservable(c.data);var q=ko.utils.unwrapObservable(c.graph);var g=ko.utils.unwrapObservable(c.bands.y);var n=ko.utils.unwrapObservable(c.view);
q.selectAll("circle").remove();ko.bindingHandlers.scattergraph.clearAxis(q);if(!i||i.length===0){return -1;}var b=d3.time[n];var a=d3.time.scale().domain([new Date(i[0].date),b.offset(new Date(i[i.length-1].date),1)]).rangeRound([0,r.width-e.left-e.right]);var f=d3.scale.linear().domain([0,100]).range([(r.height-e.top-e.bottom-e.bottom),0]);
var p=q.selectAll("g").data(i);var o=p.enter().append("circle").attr("cy",function(s,t){var u=f(s.avg);return u;}).attr("cx",function(t,u){var s=a(t.date);return s;}).attr("r",8).attr("class",function(s,t){if(s.avg<=g[0]){return"point red";}else{if(s.avg<=g[1]){return"point amber";}else{return"point green";
}}});ko.bindingHandlers.scattergraph.drawXAxis(q,a,r,e,n);ko.bindingHandlers.scattergraph.drawYAxis(q,f,r,e,n);}};ko.bindingHandlers.linegraph={margin:{top:10,left:40,bottom:10,right:0},size:function(b){var a=b.offsetHeight||320;var c=b.offsetWidth||320;return{"width":c,"height":a};},clearAxis:function(a){a.selectAll(".axis").remove();
},drawXAxis:function(g,b,d,f,a){var h=d3.time.format("%a %d");var c=5;var e=d3.svg.axis().scale(b).orient("bottom").ticks(c).tickFormat(h).tickSize(1,1).tickPadding(8);g.append("g").attr("class","x axis").attr("transform","translate(0, "+(d.height-f.top-f.bottom-f.top)+")").call(e);},drawYAxis:function(e,a,c,d){var b=d3.svg.axis().scale(a).orient("left").tickFormat(function(f){return f+"";
}).tickSize(1,1).ticks(4);e.append("g").attr("class","y axis").attr("transform","translate(0, 0)").call(b).append("text");},normaliseCSV:function(b){var a=[];for(var g=0;g<b[0].length;g++){a.push({name:b[0][g],min:0,max:0,scalar:0});}for(var g=1;g<b.length;g++){var l=b[g];for(var d=1;d<l.length;d++){if(l[d]&&l[d]!==""){var f=+l[d];
if(f<a[d].min){a[d].min=f;}if(f>a[d].max){a[d].max=f;}}}}for(var g=1;g<a.length;g++){a[g].scalar=100/a[g].max;}var k=[];for(var g=0;g<b.length;g++){var c=b[g];var h=[];for(var e=0;e<c.length;e++){var f=+c[e];if(!f||f===NaN){h.push(c[e]);}else{h.push(f*a[e].scalar);}}k.push(h);}return k;},parseCSV:function(c,l){l=l||d3.time.format("%d-%b-%y");
var k={ranges:[],limits:{xMin:0,xMax:0,yMin:0,yMax:0}};var b=k.ranges;var a=k.limits;var e=c[0];for(var h=0;h<e.length;h++){b.push({name:e[h],values:[]});}for(var h=1;h<c.length;h++){var n=c[h];var f=n[0];var m=l.parse(f);if(h===1){a.xMin=m;}if(h===c.length-1){a.xMax=m;}for(var d=1;d<n.length;d++){b[d].col=d;
if(n[d]&&n[d]!==""){var g=+n[d];if(g<a.yMin){a.yMin=g;}if(g>a.yMax){a.yMax=g;}b[d].values.push({date:m,val:g});}}}b.splice(0,1);return k;},init:function(d,e,g,c,a){var h=ko.utils.unwrapObservable(e());var b=ko.bindingHandlers.linegraph.size(d);var f=ko.bindingHandlers.linegraph.margin;h.graph=d3.select(d).append("svg").attr("class","graph").attr("width",b.width).attr("height",b.height).append("g").attr("transform","translate("+f.left+","+f.top+")").attr("height",b.height-f.top-f.bottom);
},update:function(b,i,f,c,m){var p=ko.bindingHandlers.linegraph.size(b);var o=ko.bindingHandlers.linegraph.margin;var d=ko.utils.unwrapObservable(i());var t=ko.utils.unwrapObservable(d.data);var a=ko.utils.unwrapObservable(d.graph);phil.utils.applyCssBindings(b,d);a.selectAll("g").remove();ko.bindingHandlers.linegraph.clearAxis(a);
if(!t||t.length===0){return -1;}if(d.normalise()){t=ko.bindingHandlers.linegraph.normaliseCSV(t);}var k=ko.bindingHandlers.linegraph.parseCSV(t,{parse:the.parseDateTime});var e=k.ranges;var g=k.limits;var r=d3.time.scale().domain([g.xMin,d3.time.day.offset(g.xMax,1)]).rangeRound([0,p.width-o.left-o.right]);
var s=d3.scale.linear().domain([g.yMin,g.yMax]).range([(p.height-o.top-o.bottom-o.bottom),0]);var l=d3.scale.linear().range([0,p.width]);var h=d3.scale.linear().range([p.height,0]);var n=d3.svg.line().interpolate(d.interpolate).x(function(u){return r(u.date);}).y(function(u){return s(u.val);});var q=a.selectAll("g").data(e);
q.enter().append("g");q.append("path").attr("class",function(u){if(!u.name){return"";}return"line "+"line"+u.col;}).attr("d",function(u){return n(u.values);});q.append("text").datum(function(u){return{name:u.name,value:u.values[u.values.length-1]};}).attr("transform",function(u){if(!u.value){return"translate("+r(g.xMax)+","+(s(g.yMin)-20)+" )";
}return"translate("+r(u.value.date)+","+s(u.value.val)+")";}).attr("x",3).attr("dy",".35em").text(function(u){return u.name;});ko.bindingHandlers.linegraph.drawXAxis(a,r,p,o);ko.bindingHandlers.linegraph.drawYAxis(a,s,p,o);}};ko.components.register("csv-table",{viewModel:function(a){this.csv=phil.collections.CSVTable();
ko.computed(function(){var c=[];if(a.data){c=ko.unwrap(a.data);}this.csv([]);for(var b=0;b<c.length;b++){this.csv.insertRow(c[b]);}},this);phil.observe([]);},template:'<div data-bind="foreach:csv" class="csv-table">'+"<!-- ko if:$index()===0 -->"+'	<div data-bind="foreach:$data" class="csv-tr">'+'	   	<div data-bind="html:$data.value, css:$data.style" class="csv-td csv-th"></div>'+"	</div>"+"<!-- /ko -->"+"<!-- ko if:$index()>0 -->"+'   <div data-bind="foreach:$data" class="csv-tr">'+'       <div data-bind="html:$data.value, css:$data.style" class="csv-td"></div>'+"   </div>"+"<!-- /ko -->"+"</div>"});
ko.components.register("phone-number",{viewModel:function(d){function c(f){var e={area:"",local:""};f=f.replace(/[\D]/g,"");e.area=f.substring(0,5);e.local=f.substring(5,8)+" "+f.substring(8);return e;}function b(f,e){return f+" "+e;}this.value=d.value||ko.observable("");var a=c(this.value());this.area=ko.observable(a.area);
this.local=ko.observable(a.local);this.value(b(this.area(),this.local()));this.area.subscribe(function(e){this.value(b(this.area(),this.local()));}.bind(this));this.local.subscribe(function(e){this.value(b(this.area(),this.local()));}.bind(this));},template:'<span class="phone-number">'+'<input data-bind="value:area" class="txt"/>'+'<input data-bind="value:local" class="txt"/>'+"</span>"});
ko.extenders.escape=function(c,a){function b(){var d=phil.escape(this.target());if(d!==this.target()){this.disposeCallback();this.target(d);this.target.subscribe(this.callback);}}c.subscribe(b);c.valueHasMutated();return c;};ko.extenders.required=function(b,a){b.hasError=ko.observable(false);function c(d){if(a){if(!d||d===""){b.hasError(true);
}}}b.subscribe(c);return b;};ko.extenders.validate=function(b,a){b.subscribe(a);return b;};(function(b){var a="phil:cards:generic";var c=function(){return phil.cards.Generic;};b.create=function(h,e,i){h=h||{};i=i||c;var e=e||h.name;if(!e){return -1;}var d=phil.cards[e]||undefined;var f=false;if(!d){d=i();
f=true;}var g=d.call(this,h);g.autoSupport=f;return g;};b.Abstract=function(d){d=d||{};this.model=d.data;this.id=d.id;this.name=d.name||"";this._card=d.card;this._tmpl=d.tmpl;};b.Abstract.prototype={};b.Abstract.prototype.update=function(d){};b.Abstract.prototype.tmpl=function(){var e=this._tmpl||this._card;
var d=document.getElementById(e);if(!d){e=c().template();}return e;};b.Abstract.prototype.decard=function(){var d=new phil.cards.Promise().create(this);return d;};})(__ns("phil.cards"));(function(a){a.Action=function(b){b=b||{};this._action=b.action||undefined;this.btnDefaultAction=new phil.model.Button({value:"",handler:function(d,e){try{var f=this.decard();
f["_event"]=e;this.trigger("action.click",f);}catch(c){console.log(c);}}});if(this._action&&this._action["delete"]){this.btnDeleteAction=new phil.model.Button({value:"",handler:function(d,e){try{var f=this.decard();f["_event"]=e;this.trigger("action.delete",f);}catch(c){console.log(c);}}});}};a.Action.prototype={};
})(__ns("phil.cards"));(function(b){var a="primary";var c="foreign";b.Appflow=function(d){d=d||{};if(!d.appFlow){return -1;}this.appFlow=d.appFlow||undefined;this.foreignKey=d.foreignKey;this.primaryKey=d.primaryKey;if(this.appFlow.update){this.btnUpdateFlow=new phil.model.Button({value:"",handler:function(e,f){var g=this.decard();
g.context=this.getContext(a);this.trigger("appflow.edit",g);}});}if(this.appFlow.create){this.btnCreateFlow=new phil.model.Button({value:"",handler:function(e,f){var g=this.decard();g.context=this.getContext(c);this.trigger("card.expand",{});this.trigger("appflow.create",g);}});}if(this.appFlow["delete"]){this.btnDeleteFlow=new phil.model.Button({value:"",handler:function(e,f){var g=this.decard();
g.context=this.getContext(a);this.trigger("appflow.delete",g,this._parent);}});}};b.Appflow.prototype={};b.Appflow.prototype.appflowTemplate=function(){return[,"<!-- ko if:$data.appFlow -->","<!-- ko if:$data.appFlow.update -->",'<button data-bind="button:$data.btnUpdateFlow" class="btn btn-background ico-ios7 ico-edit-inv"></button>',"<!-- /ko -->","<!-- ko if:$data.appFlow.create -->",'<button data-bind="button:$data.btnCreateFlow" class="btn btn-background ico-ios7 ico-plus-inv"></button>',"<!-- /ko -->","<!-- ko if:$data.appFlow.delete -->",'<button data-bind="button:$data.btnDeleteFlow" class="btn btn-background ico-ios7 ico-subtract-inv"></button>',"<!-- /ko -->","<!-- /ko -->"];
};b.Appflow.prototype.getContext=function(e){var d={"contextCardId":this.id};if(e===c){if(this.foreignKey){d["contextCardKey"]=this.foreignKey.value;}}else{if(e===a){if(this.primaryKey){d["contextCardKey"]=this.primaryKey.value;}}}return d;};b.Appflow.prototype.clone=function(e){var g={};for(var d in e){if(d.indexOf("_")===-1){var f=e[d];
g[d]=ko.isObservable(f)?f():f;}}return g;};})(__ns("phil.cards"));(function(a){a.Base=function(b){b=b||{};var c={};c._listeners={};c._parentTrigger=undefined;c["_parent"]=b["_parent"];c.listen=function(d,e){this._listeners[d]=this._listeners[d]||[];this._listeners[d][this._listeners[d].length]=e;};c.trigger=function(d,f){if(this._listeners[d]){for(var e=0;
e<this._listeners[d].length;e++){this._listeners[d][e].call(this,f,this);}}if(c._parentTrigger){c._parentTrigger(d,f);}};c.update=function(d,e){};c.id=b.id;c.type=b.type;c.cardType=b.cardType||c.type;c.value=b.value;c.oVisible=phil.observe(true);c.oSelected=phil.observe(false);c.oExpanded=phil.observe(0);
c.oFlipSelected=function(){this.oSelected(!this.oSelected());this.trigger("selected",{"selected":this.oSelected()});};c.oFlipExpanded=function(){if(this.oExpanded()===0){this.oExpanded(1);}else{this.oExpanded(0);}};return c;};})(__ns("phil.cards"));(function(a){a.Bundle=function(b){b=b||{};var c={};c["_name"]=b.name;
c.standardise=b.standardise||function(d){return d;};c.loaded=b.loaded||function(){};c.performance=b.legacy?{"batch":15,"delay":10}:{"batch":50,"delay":0};c.selectionFn=b.selectionFn||function(){};c.sorterFn=b.sortBy||undefined;c.el=b.el||{};c.data=phil.observePausable([]);c.createCard=function(d,e,g){var f=d.call(g,e);
f.listen("selected",c.selectionFn);return f;};c.clear=function(){c.data([]);};c.addCard=function(e,h){if(!e.type){the.log.error(this,"Cannot add card without a type. Invalid Card structure.");return -1;}var d=phil.cards[e.type]||phil.cards["Base"];var f=undefined;try{f=c.createCard(d,e,h);c.insert(f);
}catch(g){the.log.error("Bundle","Error creating card ["+g.message+"]");}return f;};c.refreshCard=function(d,f){if(!d.type){the.log.error(this,"Cannot add card without a type. Invalid Card structure.");return -1;}var e=c.data()[f];e.update(d,"baselined");};c.addIfNot=function(d){var h=false;var e=c.data();
for(var g=0;g<e.length;g++){var f=e[g];if(f.id===d.id){h=true;break;}}if(!h){c.push([d]);}};c.checkIf=function(h){var k=-1;var e=c.data();for(var g=0;g<e.length;g++){var f=e[g];var d=h(f);if(d>=0){k=g;break;}}return k;};c.getById=function(g){var e=g;var d=c.checkIf(function f(h){if(h.id===e){return 0;
}return -1;});if(d>=0){return c.data()[d];}else{undefined;}};c.delIf=function(g){if(!g){return;}var d=c.data();for(var f=0;f<d.length;f++){var e=d[f];if(e.id===g.id){c.data.splice(f,1);break;}}};c.name=phil.observe("card-href");c.expansion=phil.observe(1);c.filter=phil.observe("");c.filterFn=function(n,e){function d(i,q){var r=undefined;
if(!i){return false;}if(i["label"]){r=i["label"];}else{r=i;}r=r.toLowerCase();if(r.indexOf(e)>-1){return true;}else{return false;}}function m(q,r,i){var s=undefined;if(q[i]){s=q[i];}if(!s){return false;}s=s.toLowerCase();if(s.indexOf(e)>-1){return true;}else{return false;}}var o=0;var f=e.split(" ");
var p=n.oTags();for(var h=0;h<f.length;h++){var e=f[h];var l=undefined;if(e.indexOf(":")>=0){var g=e.split(":");l=g[0];e=g[1];}var k;if(l){k=m(n,e,l);if(k===true){o++;}}else{for(j=0;j<p.length;j++){k=d(p[j],e);if(k===true){o++;}}}}return o===f.length?true:false;};c.filterComplete=function(){};c.filtered=ko.computed(function(){var d;
var f=c.data();if(c.sorterFn){f=f.sort(c.sorterFn);}var e=c.filter().toLowerCase();if(!c.data._paused){__.each(f,function(l,g,n){for(var k=0;k<l.length;k++){var h=l[k];if(e===""){h.oVisible(true);}else{var m=c.filterFn(h,e);h.oVisible(m);}}},function(g){if(c.filterComplete){c.filterComplete();}},{batch:10});
}return f;},this);c.each=function(f){var d=c.data();for(var e=0;e<d.length;e++){f.call(this,d[e]);}};c.getSelected=function(){var d=[];c.each(function(e){if(e.oSelected()){d.push(e);}});return d;};c._insert=function(){return false;};c.insert=function(d){var k=0;var e=c.data();for(var h=0;h<e.length;h++){var f=e[h];
var g=c._insert(f,d);if(g===true){k=h;break;}}e.splice(k,0,d);};c.load=function(e,d){d=d||{};d.refresh=d.refresh||false;d.deletemissing=d.deletemissing||false;c.pause();if(d.refresh){host.data([]);}__.each2(e,function(f,g,h){f=c.standardise(f);var g=c.checkIf(function(i){if(i.id===f.id){return 0;}return -1;
});if(g===-1){c.addCard(f);}else{c.refreshCard(f,g);}},function(f){c.resume();if(!f){c.loaded();}},c.performance);};c.tmpl=function(d){return d.type?"card-"+d.type:"card-default";};c.pause=function(){c.data.pause();};c.resume=function(){c.data.resume();};c.push=function(e){for(var d=0;d<e.length;d++){c.data.push(e[d]);
}};c.splice=function(e,f,d){c.data.splice(e,f,d);};return c;};})(__ns("phil.cards"));(function(b){var a="primary";var c="foreign";b.Collapsible=function(d){d=d||{};if(!d.collapsible){return -1;}this.collapsible=true;this.collapsed=phil.observe(true);this.btnCollapse=new phil.model.Button({value:"",handler:function(e,f){this.collapsed(!this.collapsed());
}});};b.Collapsible.prototype={};})(__ns("phil.cards"));phil.cards["Generic"]=function(a){var b=new phil.cards.Abstract(a);b.genericClick=function(){};__mixin(b,new phil.model.Nodes());if(a.collapsible){__mixin(b,new phil.cards.Collapsible(a));b.listen("card.expand",function(){this.collapsed(false);}.bind(b));
}if(a.appFlow){__mixin(b,new phil.cards.Appflow(a));}if(a.action){__mixin(b,new phil.cards.Action(a));b.genericClick=function(d,c){if(this.btnAction){this.btnAction.handler.call(this,d,c);}};}if(a.selectable){__mixin(b,new phil.cards.Selectable(a));}b.label=phil.observe(a.label||"");b.autoSupport=true;
b.update=function(d){if(!d){return -1;}if(d.label){b.label(d.label);}for(var c=0;c<d.properties.length;c++){b.updateSupported(d.properties[c]);}};return b;};phil.cards["Generic"].template=function(){var b=document.getElementById("phil:cards:generic");if(b){return"phil:cards:generic";}var a=[,'<span data-bind="click:$data.genericClick" name="phil:cards:generic" class="card-inner span width8">','<div class="inner-title">',"<!-- ko if:$data.btnSelectAction -->",'<button data-bind="button:$data.btnSelectAction, css:{ \'active\':$data._selected()===true }" name="select" type="button" class="btn btn-boolean width1 height2 active" style="max-width:32px; margin-right:4px;"></button>',"<!-- /ko -->",'<p data-bind="html:$data.label" class="card-title width8">{label}</p>',"</div>",'<div class="inner-body">',"<!-- ko foreach:$data._children -->","<!-- ko if:$data._instance -->","<!-- ko if:$data._instance==='phil.model.SmartActor' -->",ko.bindingHandlers.smartactor.tmpl(),"<!-- /ko -->","<!-- ko if:$data._instance==='phil.model.SmartBoolean' -->",ko.bindingHandlers.smartboolean.tmpl(),"<!-- /ko -->","<!-- ko if:$data._instance==='phil.model.SmartDate' -->",ko.bindingHandlers.smartdate.tmpl(),"<!-- /ko -->","<!-- ko if:$data._instance==='phil.model.SmartDateTime' -->",ko.bindingHandlers.smartdatetime.tmpl(),"<!-- /ko -->","<!-- ko if:$data._instance==='phil.model.SmartImage' -->",ko.bindingHandlers.smartimage.tmpl(),"<!-- /ko -->","<!-- ko if:$data._instance==='phil.model.SmartParagraph' -->",ko.bindingHandlers.smartparagraph.tmpl(),"<!-- /ko -->","<!-- ko if:$data._instance==='phil.model.SmartString' -->",ko.bindingHandlers.smartstring.tmpl(),"<!-- /ko -->","<!-- ko if:$data._instance==='phil.model.SmartTime' -->",ko.bindingHandlers.smarttime.tmpl(),"<!-- /ko -->","<!-- /ko -->","<!-- /ko -->","</div>","</span>",'<span data-bind="css:{\'width2\':!$data.collapsible }" class="span width1 align-right align-top">',"<!-- ko if:$data.appFlow -->","<!-- ko if:$data.appFlow.update -->",'<button data-bind="button:$data.btnUpdateFlow" class="btn btn-background ico-ios7 ico-edit-inv"></button>',"<!-- /ko -->","<!-- ko if:$data.appFlow.create -->",'<button data-bind="button:$data.btnCreateFlow" class="btn btn-background ico-ios7 ico-add-inv"></button>',"<!-- /ko -->","<!-- ko if:$data.appFlow.delete -->",'<button data-bind="button:$data.btnDeleteFlow" class="btn btn-background ico-ios7 ico-subtract-inv"></button>',"<!-- /ko -->","<!-- /ko -->","<!-- ko if:$data._action -->","<!-- ko if:$data._action.delete -->",'<button data-bind="button:$data.btnDeleteAction" class="btn btn-background ico-ios7 ico-subtract-inv"></button>',"<!-- /ko -->",'<button data-bind="button:$data.btnDefaultAction" class="btn btn-background ico-ios7 ico-next-inv"></button>',"<!-- /ko -->","</span>",'<span data-bind="css:{\'width1\':$data.collapsible}" class="span align-right align-top">',"<!-- ko if:$data.collapsible -->",'<button data-bind="button:$data.btnCollapse, css:{ \'active\':!$data.collapsed() }" name="select" type="button" class="btn btn-expander width1 height2 active" style="max-width:32px; margin-right:4px;"></button>',"<!-- /ko -->","</span>"].join("");
$("body").prepend('<script type="text/phil" id="phil:cards:generic">'+a+"<\/script>");return"phil:cards:generic";};(function(a){a.Promise=function(b){this._includes=b;};a.Promise.prototype={};a.Promise.prototype.create=function(d){d=d||{};function c(g){var f=undefined;for(var h=0;h<this.entry.length;
h++){if(this.entry[h].name===g){f=this.entry[h];break;}}return f;}var b=d.childrenToJs?d.childrenToJs():[];var e={"_note_":"delivered by cards.promise","id":this.validate(d.id),"name":this.validate(d.name),"label":this.validate(d.label),"entry":this.entries(b),"appFlow":d.appFlow||{},"findByName":c};
return e;};a.Promise.prototype.validate=function(b){if(!b){return undefined;}return ko.isObservable(b)?b():b;};a.Promise.prototype.entries=function(b){var d=[];for(var c=0;c<b.length;c++){d.push({"id":b[c].id||"","name":b[c].name||"","value":b[c].value||""});}return d;};})(__ns("phil.cards"));(function(a){a.Selectable=function(b){b=b||{};
this._selected=phil.observe(false);this.btnSelectAction=new phil.model.Button({value:"",handler:function(d,e){try{var f=this.decard();this._selected(!this._selected());if(this._selected()){this.trigger("action.selected",f);}else{this.trigger("action.unselected",f);}}catch(c){console.log(c);}}});};a.Selectable.prototype={};
})(__ns("phil.cards"));(function(a){a.Abstract=function(b){b=b||{};this._id=b.id;this._book=b.book;this.tmpl=b.tmpl||b.book;};a.Abstract.prototype={};a.Abstract.prototype.update=function(b){};})(__ns("phil.books"));(function(a){a.Book=function(b){var c=new phil.books.Abstract(b);__mixin(c,new phil.model.Nodes(b));
c._label=phil.observe(b.label);c.update=function(d){c._label(d.label);};return c;};})(__ns("phil.books"));